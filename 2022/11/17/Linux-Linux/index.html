<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Linux基础(持续更新中...) | 优秀い</title><meta name="author" content="优秀い"><meta name="copyright" content="优秀い"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="Linux基础 1.‘’ “” &#96;&#96; { } 的介绍  单引号：变量和命令都不识别。都当成普通的字符串 --最傻 双引号：不能识别命令，可以识别变量 --半傻不精 反引号：变量和命令都能识别 花括号：可以实现打印重复字符从的简化形式 123456789101112131415#单引号、双引号、反引号的区别：[root@localhost ~]# echo &amp;#x27;echo $HOSTNAME&amp;">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux基础(持续更新中...)">
<meta property="og:url" content="http://zhangguichuan.top/2022/11/17/Linux-Linux/index.html">
<meta property="og:site_name" content="优秀い">
<meta property="og:description" content="Linux基础 1.‘’ “” &#96;&#96; { } 的介绍  单引号：变量和命令都不识别。都当成普通的字符串 --最傻 双引号：不能识别命令，可以识别变量 --半傻不精 反引号：变量和命令都能识别 花括号：可以实现打印重复字符从的简化形式 123456789101112131415#单引号、双引号、反引号的区别：[root@localhost ~]# echo &amp;#x27;echo $HOSTNAME&amp;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://zhangguichuan.top//picture/default_cover_40.webp">
<meta property="article:published_time" content="2022-11-17T12:44:59.166Z">
<meta property="article:modified_time" content="2022-12-08T09:13:39.961Z">
<meta property="article:author" content="优秀い">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://zhangguichuan.top//picture/default_cover_40.webp"><link rel="shortcut icon" href="/picture/favicon.ico"><link rel="canonical" href="http://zhangguichuan.top/2022/11/17/Linux-Linux/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Linux基础(持续更新中...)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-12-08 17:13:39'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><link rel="stylesheet" href="/css/jianbian.css"><link rel="stylesheet" href="/css/shouji.css"><link rel="stylesheet" href="/css/fengche.css"><link rel="stylesheet" href="/css/gerenjianbian.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css"><link rel="stylesheet" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.css" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/picteurl/01.jpg" data-lazy-src="/picture/head.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">10</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-rocket"></i><span> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/life/"><i class="fa-fw fa-solid fa-dragon"></i><span> 生活</span></a></li><li><a class="site-page child" href="/love/"><i class="fa-fw fas fa-heart"></i><span> 恋爱屋</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fa-solid fa-pen"></i><span> 关于</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background: \picture\default_cover_40.webp"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">优秀い</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa-solid fa-rocket"></i><span> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/life/"><i class="fa-fw fa-solid fa-dragon"></i><span> 生活</span></a></li><li><a class="site-page child" href="/love/"><i class="fa-fw fas fa-heart"></i><span> 恋爱屋</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fa-solid fa-pen"></i><span> 关于</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Linux基础(持续更新中...)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-11-17T12:44:59.166Z" title="发表于 2022-11-17 20:44:59">2022-11-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-12-08T09:13:39.961Z" title="更新于 2022-12-08 17:13:39">2022-12-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Linux/">Linux</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">17.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>69分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Linux基础(持续更新中...)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>Linux基础</h1>
<h1>1.‘’ “” `` { } 的介绍</h1>
<blockquote>
<p>单引号：<font color='red'>变量和命令都不识别</font>。都当成普通的字符串 --最傻<br>
双引号：<font color='red'>不能识别命令，可以识别变量</font> --半傻不精<br>
反引号：<font color='red'>变量和命令都能识别</font></p>
<p>花括号：可以实现打印重复字符从的简化形式</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">单引号、双引号、反引号的区别：</span></span><br><span class="line">[root@localhost ~]# echo &#x27;echo $HOSTNAME&#x27;</span><br><span class="line">echo $HOSTNAME</span><br><span class="line">[root@localhost ~]# echo &quot;echo $HOSTNAME&quot;</span><br><span class="line">echo localhost.localdomain</span><br><span class="line">[root@localhost ~]# echo `echo $HOSTNAME`</span><br><span class="line">localhost.localdomain</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">花括号：</span></span><br><span class="line">[root@localhost ~]# echo &#123;1..10&#125;</span><br><span class="line">1 2 3 4 5 6 7 8 9 10</span><br><span class="line">[root@localhost ~]# echo &#123;1..10..2&#125;</span><br><span class="line">1 3 5 7 9</span><br><span class="line">[root@localhost ~]# echo &#123;a..z&#125;</span><br><span class="line">a b c d e f g h i j k l m n o p q r s t u v w x y </span><br></pre></td></tr></table></figure>
</blockquote>
<h1>用户管理</h1>
<p><strong>useradd</strong>创建新用户</p>
<p>usermod修改用户</p>
<p>userdel删除用户</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-u	指定UID</span><br><span class="line">-g	指定GID</span><br><span class="line">-p	指定创建用户的密码</span><br></pre></td></tr></table></figure>
<h1>文件权限</h1>
<blockquote>
<p>r 可使用文件查看类工具，比如：cat，可以获取其内容</p>
<p>w 可修改其内容,文件的是否被删除和文件的权限无关</p>
<p>x 可以把此文件提请内核启动为一个进程，即可以执行（运行）此文件（此文件的内容必须是可执行） 文件权限常见组合</p>
<p>— 0</p>
<p>r  4</p>
<p>r-x 5</p>
<p>rw 6</p>
<p>rwx 7</p>
</blockquote>
<p><strong>chmod修改权限</strong></p>
<h2 id="新建文件和目录的默认权限">新建文件和目录的默认权限</h2>
<p>umask的值可以用来保留在创建文件权限</p>
<p>实现方式：</p>
<ul>
<li>新建文件的默认权限：666-umask，如果所得某位存在执行(奇数)权限，则将其权限+1，偶数不变</li>
<li>新建目录的默认权限：777-umask</li>
</ul>
<p>非特权用户umask默认是：<font color='red'>002</font></p>
<p>root的umask默认是：<font color='red'>022</font></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# umask</span><br><span class="line">0022</span><br><span class="line">[root@localhost ~]# su - zhang</span><br><span class="line">上一次登录：二 9月 27 23:02:06 CST 2022pts/0 上</span><br><span class="line">[zhang@localhost ~]$ umask</span><br><span class="line">0002</span><br></pre></td></tr></table></figure>
<p>持久保存umask</p>
<ul>
<li>全局设置：/etc/bashrc	全部用户包括root</li>
<li>用户设置：~/.bashrc       仅限当前用户</li>
</ul>
<p>案例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# touch zhang.txt</span><br><span class="line">[root@localhost ~]# ll</span><br><span class="line">-rw-r--r--. 1 root root    0 9月  28 01:38 zhang.txt</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">默认权限 666 减去root的<span class="built_in">umask</span> 022 666-022=644</span></span><br></pre></td></tr></table></figure>
<p>如果只实现临时性的文件权限为000</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">有三张方法：</span><br><span class="line">1、 touch a.txt; chmod 000 a.txt</span><br><span class="line">2、 umask 777; touch a.txt ; umask 022 #先修改umask的值，</span><br><span class="line">3、(umsk 777; touch a.txt) #小括号内的umask是一次性有效的</span><br></pre></td></tr></table></figure>
<h2 id="特殊权限">特殊权限</h2>
<ul>
<li>suid继承这个文件所有者的权限 4</li>
<li>sgid继承所属组的权限。在目录上，此目录中新建的文件的所属组将自动从此目录继承 2</li>
<li>sticky 粘滞位，用于目录上，此目录中的文件只能由自己删除，不能其他人删除 1</li>
</ul>
<p><strong>特殊属性</strong></p>
<p>设置文件的特殊属性，可以访问root用户误操作删除或修改文件</p>
<p>不能删除、改名，更改</p>
<blockquote>
<p>chattr +i file</p>
</blockquote>
<p>只能追加内容，不能删除，改名</p>
<blockquote>
<p>chattr +a file</p>
</blockquote>
<p>显示特定属性</p>
<blockquote>
<p>lsattr</p>
</blockquote>
<h1>vim</h1>
<h2 id="基础模式">基础模式</h2>
<p><strong>插入模式：</strong></p>
<p><font color='red'>i、a     在光标出插入</font><br>
<font color='red'>o       换行插入</font><br>
<font color='red'>A       光标到行尾</font><br>
<font color='red'>I       光标到行首</font><br>
<font color='red'>O       在上一行插入</font></p>
<p><strong>扩展模式：</strong></p>
<p>:wq       保存并退出<br>
:q!       强制退出，不保持<br>
<font color='red'>:X        给该文件加密</font><br>
<font color='red'>:!+命令   在vi界面执行命令</font><br>
<font color='red'>:r!+命令  读入命令的输出</font>，就是把命令的结果写入到该文件里</p>
<h2 id="地址定界"><strong>地址定界</strong></h2>
<p>格式:</p>
<blockquote>
<p><font color='red'>:start_pos,end_pos CMD</font></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="comment">#具体第#行，例如2表示第2行</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">,<span class="comment"># #从左侧#表示起始行，到右侧#表示结尾行</span></span> </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">,+<span class="comment"># #从左侧#表示的起始行，加上右侧#表示的行数，范例：2,+3 表示2到5行</span></span></span><br><span class="line">.   #当前行</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="comment">#最后一行</span></span></span><br><span class="line">.,$-1 #当前行到倒数第二行</span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash"><span class="comment">#全文, 相当于1,$</span></span></span><br><span class="line">/pattern/   #从当前行向下查找，直到匹配pattern的第一行,即:正则表达式</span><br><span class="line">/pat1/,/pat2/ #从第一次被pat1模式匹配到的行开始，一直到第一次被pat2匹配到的行结束</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">,/pat/     <span class="comment">#从指定行开始，一直找到第一个匹配pattern的行结束</span></span></span><br><span class="line">/pat/,$     #向下找到第一个匹配patttern的行到整个文件的结尾的所有行</span><br></pre></td></tr></table></figure>
<p>地址定界后跟一个编辑命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">y #复制</span><br><span class="line">w file #将范围内的行另存至指定文件中</span><br><span class="line">r file #在指定位置插入指定文件中的所有内容</span><br><span class="line"><span class="meta prompt_">t#</span><span class="language-bash">行号     将前面指定的行复制到<span class="comment">#行后</span></span></span><br><span class="line"><span class="meta prompt_">m#</span><span class="language-bash">行号     将前面指定的行移动到<span class="comment">#行后</span></span></span><br></pre></td></tr></table></figure>
<h2 id="查找并替换">查找并替换</h2>
<p>格式：</p>
<blockquote>
<p><font color='red'>s/要查找的内容/要替换的内容/修饰符</font></p>
</blockquote>
<p>说明：</p>
<blockquote>
<p>要查找的内容：可使用基本正则表达式模式<br>
替换为的内容：不能使用模式，但可以使用\1, \2, …等后向引用符号；还可以使用“&amp;”引用前面查找时查 找到的整个内容</p>
</blockquote>
<p>修饰符：</p>
<blockquote>
<p>i #忽略大小写<br>
<font color='red'>g </font>#全局替换(贪婪模式)，默认情况下，每一行只替换第一次出现 （懒惰模式）<br>
gc #全局替换，每次替换前询问</p>
</blockquote>
<p>查找替换中的分隔符/ 可以替换位其他字符比如：#，@</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">比如：</span></span><br><span class="line">s@/etc@/var@g</span><br><span class="line"><span class="meta prompt_">s#</span><span class="language-bash">/boot<span class="comment">#/#i</span></span></span><br></pre></td></tr></table></figure>
<h2 id="自定义vim工作特性">自定义vim工作特性</h2>
<p>扩展命令模式的配置只是对当前vim进程有效，可将配置存放在文件中持久保存</p>
<p>配置文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">/etc/vimrc #全局</span><br><span class="line">~/.vimrc #个人</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">自定义行号</span></span><br><span class="line">显示：set number，简写 set nu</span><br><span class="line">取消显示：set nonumber, 简写 set nonu</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">自动缩进</span></span><br><span class="line">启用：set autoindent，简写 set ai</span><br><span class="line">禁用：set noai</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">保留复制格式</span></span><br><span class="line">启用：set paste</span><br><span class="line">禁用：set nopaste</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">显示Tab ^I和换行符 和$显示</span></span><br><span class="line">启用：set list</span><br><span class="line">禁用：set nolist</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">文件格式</span></span><br><span class="line">启用windows格式：set fileformat=dos</span><br><span class="line">启用unix格式：set fileformat=unix</span><br><span class="line">简写 set ff=dos|unix</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Tab 用空格代替</span></span><br><span class="line">启用：set expandtab   默认为8个空格代替Tab</span><br><span class="line">禁用：set noexpandtab</span><br><span class="line">简写：set et </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Tab用指定空格的个数代替</span></span><br><span class="line">启用：set tabstop=# 指定#个空格代替Tab</span><br><span class="line">简写：set ts=4</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设置缩进宽度</span></span><br><span class="line">向右缩进 命令模式&gt;&gt;</span><br><span class="line">向左缩进 命令模式&lt;&lt;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设置缩进为4个字符</span></span><br><span class="line">启用：set cursorline，简写 set cul</span><br><span class="line">禁用：set nocursorline</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">文件加密</span></span><br><span class="line">启用： set key=password</span><br><span class="line">禁用： set key=</span><br></pre></td></tr></table></figure>
<h2 id="命令模式">命令模式</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">退出vim</span></span><br><span class="line">ZZ  保存退出</span><br><span class="line">ZQ  不保存退出</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">光标跳转</span></span><br><span class="line">h:	左</span><br><span class="line">L:	右</span><br><span class="line">j:	下</span><br><span class="line">k:	上</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">单词间跳转</span></span><br><span class="line">w:	下一个单词的词首</span><br><span class="line">e:	当前或下一个单词的词尾</span><br><span class="line">b:	当前或前一个单词的词首</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">当前页跳转</span></span><br><span class="line">H:	页首</span><br><span class="line">M:	页中间行</span><br><span class="line">L:	页底</span><br><span class="line">zt:	将光标所在当前行移动到屏幕顶端</span><br><span class="line">zz：将光标所在当前行移动屏幕中间</span><br><span class="line">zb:	将光标所在当前行移动到屏幕底端</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">行首行尾跳转：</span></span><br><span class="line">^	跳转至行首的第一个非空白字符</span><br><span class="line">O	跳转至行首</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">	跳转至行尾</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1>文件查找</h1>
<h2 id="find">find</h2>
<p><strong>find</strong>是实时查找工具，通过遍历指定路劲完成文件查找</p>
<p>特点：查找速度略慢、精确，可实时查找，查找条件丰富，可能只搜索用户具备读取和执行权限的目录</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#格式</span><br><span class="line">find -选项 [查找路径] [查找条件]</span><br><span class="line">查找路径:指定具体目标路径；默认为当前目录</span><br><span class="line">查找条件:指定的查找标准，可以是文件名、大小、类型、权限等；默认找出指定路径下的所有文件</span><br><span class="line">处理动作:对符合条件的文件操作，默认输出至屏幕</span><br></pre></td></tr></table></figure>
<h2 id="参数替换xargs">参数替换xargs</h2>
<h1>正则表达式</h1>
<p>通配符通常用来处理文件名，正则表达式时处理文本内容中字符</p>
<p>正则表达式的元字符分类：字符匹配、匹配次数、位置锚定、分组</p>
<p><font color='red'>注：正则表达式放到 [ ]中括号里就不是原来的意思了</font></p>
<h2 id="字符匹配">字符匹配</h2>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">.	匹配任意单个字符</span><br><span class="line">[]	匹配指定范围内的任意单个字符，如：[zhang] [0-9] [z-a] [a-zA-Z]</span><br><span class="line">[^]	匹配指定范围外的任意单个字符，如：[^zhang]</span><br><span class="line">[:alnum:]  匹配字母和数字</span><br><span class="line">[:alpha:]  代表任何英文大写字符</span><br><span class="line">[:lower:]  小写字母，相当于[a-z]</span><br><span class="line">[:upper:]  大小写字母</span><br><span class="line">[:blank:]  空白字符(空格和制表符)</span><br><span class="line">[:space:]  比blank的范围更广</span><br><span class="line">[:cntrl:]  不可打印的控制字符(退格、删除等)</span><br><span class="line">[:digit:]  十进制数字</span><br><span class="line">[:xdigit:] 十六进制数字</span><br><span class="line">[:graph:]  可打印的非空白字符</span><br><span class="line">[:print:]  可打印字符</span><br><span class="line">[:punct:]  标点符号</span><br><span class="line">\s	匹配任何空白字符，包括空格、制表符等。等价于 [\f\r\t\v]</span><br><span class="line">\S	匹配任何非空白字符。等价于[^\f\r\t\v]</span><br><span class="line">\w #匹配一个字母,数字,下划线,汉字,其它国家文字的字符，等价于[_[:alnum:]字]</span><br><span class="line">\W #匹配一个非字母,数字,下划线,汉字,其它国家文字的字符，等价于[^_[:alnum:]字]</span><br></pre></td></tr></table></figure>
<p><strong>案例：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">找出rc开头后面是.或0-6的文件。注意；.点在[]中括号里就表示.点</span></span><br><span class="line">[root@localhost ~]# ls /etc/ | grep &#x27;rc[.0-6]&#x27;</span><br><span class="line">rc0.d</span><br><span class="line">rc1.d</span><br><span class="line">rc2.d</span><br><span class="line">rc3.d</span><br><span class="line">rc4.d</span><br><span class="line">rc5.d</span><br><span class="line">rc6.d</span><br><span class="line">rc.d</span><br><span class="line">rc.local</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">匹配没有<span class="string">&quot;#和;&quot;</span>的行。[]中括号里<span class="comment">#;是或者的意思</span></span></span><br><span class="line">[root@localhost ~]# cat test.txt </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">;</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash">line1</span></span><br><span class="line">line2</span><br><span class="line">[root@localhost ~]# grep -v &quot;[#;]&quot; test.txt </span><br><span class="line">line1</span><br><span class="line">line2</span><br></pre></td></tr></table></figure>
<h2 id="匹配次数">匹配次数</h2>
<p>用在要指定次数的字符前面，用于指定前面的字符要出现的次数</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">*	    匹配前面的字符任意次，包括次，贪婪模式:尽可能长的匹配，</span><br><span class="line">.*	    任意长度的任意字符，相当于通配符里的*</span><br><span class="line">\?	    匹配其前面的字符出现0次或1次，即：可有可无</span><br><span class="line">\+	    匹配其前面的字符出现最少1次,即肯定有且 &gt;=1次</span><br><span class="line">\&#123;n\&#125;   匹配前面的字符n次</span><br><span class="line">\&#123;m,n\&#125; 匹配前面的字符至少m次，最多n次</span><br><span class="line">\&#123;,n\&#125;	匹配前面的字符最多n次，&lt;=n</span><br><span class="line">\&#123;n,\&#125;  匹配前面的字符至少n次</span><br></pre></td></tr></table></figure>
<p><strong>案例：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">取出IP地址</span></span><br><span class="line">[root@localhost ~]# ip add show ens160</span><br><span class="line">2: ens160: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000</span><br><span class="line">    link/ether 00:0c:29:30:68:cd brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.1.10/24 brd 192.168.1.255 scope global noprefixroute ens160</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::20c:29ff:fe30:68cd/64 scope link noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">       </span><br><span class="line">[root@localhost ~]# ip add show ens160 |grep -o &#x27;[0-9]\&#123;1,3\&#125;\.[0-9]\&#123;1,3\&#125;\.[0-9]\&#123;1,3\&#125;\.[0-9]\&#123;1,3\&#125;&#x27; |head -n1</span><br><span class="line">192.168.1.10</span><br><span class="line"></span><br><span class="line">[root@localhost ~]# cat test.txt </span><br><span class="line">google</span><br><span class="line">gooooooole</span><br><span class="line">gooooogle</span><br><span class="line">gogle</span><br><span class="line">ggle</span><br><span class="line">g00000000gle</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">匹配o出现了两次或以上</span></span><br><span class="line">[root@localhost ~]# grep &quot;gooo*gle&quot; test.txt </span><br><span class="line">google</span><br><span class="line">gooooogle</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">匹配 /etc/的/出现了一次或0次</span></span><br><span class="line">[root@centos8 ~]#echo /etc/ |grep &quot;/etc/\?&quot;</span><br><span class="line">/etc/</span><br><span class="line">[root@centos8 ~]#echo /etc |grep &quot;/etc/\?&quot;</span><br><span class="line">/etc</span><br></pre></td></tr></table></figure>
<h2 id="位置锚定">位置锚定</h2>
<p>位置锚定可以用于定位出现的位置</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">grep &#x27;^[^$#]&#x27; /etc/fstab #命令解析</span><br><span class="line">第一个 ^ 表示行首</span><br><span class="line">第二个^ 排除的意思</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">行尾</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">就是<span class="comment">#号，没其他意思</span></span></span><br><span class="line">解释:第一个^去乘[]中括号里的$和#</span><br><span class="line">就是 ^$和^# 表示：空行和#开头，还有第二个^，表示排除所有总的意思就是:</span><br><span class="line">匹配不是空行和#号开头的行</span><br><span class="line"></span><br><span class="line">grep &#x27;^[^#]&#x27; /etc/fstab #命令解析</span><br><span class="line">第一个^ 行首 第二个^ 排除</span><br><span class="line">把#号开头的非空行排除了</span><br></pre></td></tr></table></figure>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">^	行首，最左侧</span><br><span class="line">$	行尾，最右侧</span><br><span class="line">^$	匹配空行</span><br><span class="line">^[[:space:]]*$ 空白行</span><br><span class="line">\&lt; 或 \b 词首锚定</span><br><span class="line">\&gt; 或 \b 词尾锚定</span><br><span class="line"></span><br><span class="line">#注意：单词是由字母、数字、下划线组成</span><br></pre></td></tr></table></figure>
<p><strong>案例：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">排除空行和<span class="comment">#开头的行</span></span></span><br><span class="line">[root@localhost ~]# grep -v &#x27;[#]&#x27; /etc/fstab |grep -v &#x27;^$&#x27; </span><br><span class="line">[root@localhost ~]# grep &#x27;^[^$#]&#x27; /etc/fstab</span><br><span class="line">[root@centos8 ~]#grep -v &#x27;^$\|#&#x27; /etc/fstab</span><br><span class="line">[root@localhost ~]# grep &#x27;^[^#]&#x27; /etc/fstab </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">在/etc/passwd里匹配root开头的行</span></span><br><span class="line">[root@localhost ~]# grep ^root /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="分组">分组()</h2>
<p>分组：()将多个字符捆绑在一起，当作一个整体处理，如\(root\)+</p>
<p>后向引用：分组括号中的模式匹配到的内容会被正则表达式引擎记录于内部的变量中，这些变量的命名 方式为: \1, \2, \3, …</p>
<p>\1 表示从左侧起第一个左括号以及与之匹配右括号之间的模式所匹配到的字符 注意: \0 表示正则表达式匹配的所有字符</p>
<p>注意： <code>后向引用</code> 引用前面的分组括号中的模式所匹配字符，而非模式本身</p>
<h2 id="或者">或者</h2>
<p>或者: |</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">案例：</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">匹配不是空行和<span class="comment">#号的行</span></span></span><br><span class="line">[root@centos6 ~]#grep -v &#x27;^\(#\|$\)&#x27; /etc/fstab</span><br></pre></td></tr></table></figure>
<h2 id="扩展正则">扩展正则</h2>
<p><strong>字符匹配</strong></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">. 任意单个字符</span><br><span class="line">[zhang]		指定范围的字符</span><br><span class="line">[^zhang]	不在指定范围的字符</span><br></pre></td></tr></table></figure>
<p><strong>次数匹配</strong></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">*	匹配前面字符任意次</span><br><span class="line">?	0或者1次</span><br><span class="line">&#123;n&#125;	匹配n次	</span><br><span class="line">&#123;m,n&#125; 至少m次，最多n次</span><br></pre></td></tr></table></figure>
<p><strong>位置锚定</strong></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">^行首</span><br><span class="line">$行尾</span><br><span class="line">\&lt;,\b 语首</span><br><span class="line">\&lt;,、b 语尾</span><br></pre></td></tr></table></figure>
<h1>三剑客</h1>
<h2 id="grep">grep</h2>
<p>grep主要对文本的(正则表达式)行基于模式进行过滤</p>
<blockquote>
<p>作用：文本搜索工具，根据用户指定的“模式”对目标文本逐行进行匹配检测；打印匹配到的行</p>
<p>模式：由正则表达式字符及文本字符所编写的过滤条件</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">常见选项：</span></span><br><span class="line">-m # 匹配n次后停止</span><br><span class="line">-v 显示不被pattern匹配的行，即取反</span><br><span class="line">-i 忽略字符大小写</span><br><span class="line">-n 显示匹配的行号</span><br><span class="line">-c 统计匹配的次数</span><br><span class="line">-o 只显示匹配到的内容</span><br><span class="line">-q 管你有没有匹配到，都不在屏幕上显示。</span><br><span class="line">-A # after, 后#行</span><br><span class="line">-B # before, 前#行</span><br><span class="line">-C # context, 前后各#行</span><br><span class="line">-e 实现多个选项间的逻辑or关系,如：grep –e ‘cat &#x27; -e ‘dog&#x27; file</span><br><span class="line">-w 匹配整个单词</span><br><span class="line">-E 使用ERE，相当于egrep</span><br><span class="line">-F 不支持正则表达式，相当于fgrep</span><br><span class="line">-P 支持Perl格式的正则表达式</span><br><span class="line">-f file 根据模式文件处理</span><br><span class="line">-r   递归目录，但不处理软链接</span><br><span class="line">-R   递归目录，但处理软链接</span><br></pre></td></tr></table></figure>
<p>案例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">显示不带<span class="string">&quot;#&quot;</span>号的行</span></span><br><span class="line">[root@localhost ~]# grep -v &quot;#&quot; /etc/fstab </span><br><span class="line">/dev/mapper/rl-root     /                       xfs     defaults        0 0</span><br><span class="line">UUID=31781593-b293-4d54-8104-7115b0f8c6d1 /boot                   xfs     defaults        0 0</span><br><span class="line">/dev/mapper/rl-swap     none                    swap    defaults        0 0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">取cpu核数</span></span><br><span class="line">[root@localhost ~]# grep -c  processor /proc/cpuinfo </span><br><span class="line">4</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">匹配含<span class="string">&quot;root&quot;</span>的行并显示行号</span></span><br><span class="line">[root@localhost ~]# grep -n root /etc/passwd</span><br><span class="line">1:root:x:0:0:root:/root:/bin/bash</span><br><span class="line">10:operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">显示包含root的行和后面三行并显示行号</span></span><br><span class="line">[root@localhost ~]# grep -nA3 root /etc/passwd</span><br><span class="line">1:root:x:0:0:root:/root:/bin/bash</span><br><span class="line">2-bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">3-daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">4-adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">--</span><br><span class="line">10:operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">11-games:x:12:100:games:/usr/games:/sbin/nologin</span><br><span class="line">12-ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</span><br><span class="line">13-nobody:x:65534:65534:Kernel Overflow User:/:/sbin/nologin</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">找出文件相同的行</span></span><br><span class="line">[root@localhost ~]# cat a.sh </span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line">[root@localhost ~]# cat b.sh </span><br><span class="line">d</span><br><span class="line">b</span><br><span class="line">a</span><br><span class="line">g</span><br><span class="line">[root@localhost ~]# grep -f a.sh b.sh </span><br><span class="line">b</span><br><span class="line">a</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="sed">sed</h2>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202212060931850.png" alt="avatar"></p>
<p>sed是行编辑器，跟grep的区别是sed可以修改文件，而grep不行</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed 选项 &#x27;script;命令&#x27; 文件路径</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">常用选项：</span></span><br><span class="line">-n	不自动打印</span><br><span class="line">-e	多点编辑</span><br><span class="line">-f	从指定文件中读取编辑脚本</span><br><span class="line">-i	编辑文件 # -i.bak,后面跟了后缀就是备份文件并原处修改</span><br><span class="line">-s	将多个文件视为单个文件，而不单个连续的长文件流</span><br><span class="line">-r 或 -E 使用扩展正则表达式</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">说明</span></span><br><span class="line">-ir   不支持</span><br><span class="line">-i -r 支持</span><br><span class="line">-ri   支持</span><br><span class="line">-ni   危险选项,会清空文件</span><br></pre></td></tr></table></figure>
<p><strong>script格式：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x27;地址命令&#x27;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">地址格式:</span></span><br><span class="line">1、不给地址就是对全文进行处理</span><br><span class="line">2、单地址: #:指定的行,$:最后一行</span><br><span class="line">3、地址范围:</span><br><span class="line"><span class="meta prompt_">	# </span><span class="language-bash">m,n		从第m行到第n行</span></span><br><span class="line"><span class="meta prompt_">	# </span><span class="language-bash">m,+n		3,+4表示从第三行到第7行</span></span><br><span class="line">4、步进: ~</span><br><span class="line">	1~2 奇数行</span><br><span class="line">	2~2 偶数行</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>命令</strong></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p 打印当前模式空间内容，追加到默认输出之后</span><br><span class="line">Ip 忽略大小写输出</span><br><span class="line">d 删除模式空间匹配的行，并立即启用下一轮循环</span><br><span class="line">a [\]text 在指定行后面追加文本，支持使用\n实现多行追加</span><br><span class="line">i [\]text 在行前面插入文本</span><br><span class="line">c [\]text 替换行为单行或多行文本</span><br><span class="line">w file 保存模式匹配的行至指定文件</span><br><span class="line">r file 读取指定文件的文本至模式空间中匹配到的行后</span><br><span class="line">= 为模式空间中的行打印行号</span><br><span class="line">! 模式空间中匹配行取反处理</span><br><span class="line">q           结束或退出sed</span><br></pre></td></tr></table></figure>
<p><strong>查找替换</strong></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">s/pattern/string/修饰符 查找替换,支持使用其它分隔符，可以是其它形式：s@@@，s###</span><br><span class="line">替换修饰符：</span><br><span class="line">g 行内全局替换</span><br><span class="line">p 显示替换成功的行</span><br><span class="line">w   /PATH/FILE 将替换成功的行保存至文件中</span><br><span class="line">I,i   忽略大小写</span><br></pre></td></tr></table></figure>
<p>案例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">关闭selinux</span></span><br><span class="line">sed -i &#x27;^SELINUX=/c SELINUX=disabled&#x27; /etc/selinux/config</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">只显示非<span class="comment">#开头的行</span></span></span><br><span class="line">[root@zhang ~]# sed -n &#x27;/^#/!p&#x27; /etc/fstab </span><br><span class="line">UUID=f90a0d2c-7d6c-4122-8c70-137b5ab7e23c /                       xfs     defaults </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">默认的sed会将输入信息直接输出，-n就关闭自动打印功能</span></span><br><span class="line">[root@zhang ~]# seq 10 |sed &#x27;3,5p&#x27;</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">[root@zhang ~]# seq 10 |sed -n &#x27;3,5p&#x27;</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="awk">awk</h2>
<p>awk：又称报告生成器，格式化文本输出，通常现在用的是GAWK</p>
<p>GAWK：模式扫描和处理语言，可以失效下面功能</p>
<ul>
<li>文本处理</li>
<li>输出格式化的文本报表</li>
<li>执行算数运算</li>
<li>执行字符串操作</li>
</ul>
<p>格式：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">awk -F选项的默认分割是空白</span></span><br><span class="line">awk [选项] &#x27;program(你要执行的操作)&#x27; var=value file(要处理的文件)</span><br><span class="line">awk [选项] -f programfile var=value file</span><br></pre></td></tr></table></figure>
<p>说明：</p>
<p>program通常被放在单引号中，并可以由三种部分组成</p>
<ul>
<li>begin语句块</li>
<li>模式匹配的通用语句块</li>
<li>end语句块</li>
</ul>
<p>常见选项：</p>
<ul>
<li>-F “分隔符” 指名输入时用到的字段分隔符，默认的分隔符时若干个连续空白符</li>
<li>-v var=value 变量赋值</li>
</ul>
<h3 id="Program格式："><strong>Program格式：</strong></h3>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pattern&#123;action statements;...&#125;</span><br></pre></td></tr></table></figure>
<p>pattern：定义了条件，只能符合条件的记录，才会执行动作语句何时触发及触发事件，比如：begin,end,正则表达式等</p>
<p>action statements：对数据进行处理，放在{ }内指明，常见：print,printf</p>
<h3 id="awk工作过程"><strong>awk工作过程</strong></h3>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.staticaly.com/gh/wqingzy/blog-img@main/img/202212071145598.png" alt="image-20221207114555426"></p>
<p>第一步：执行begin{action;…}语句块中的语句</p>
<p>第二步：从文件或标准输入(stdin)读取一行，然后执行pattern{action;…}语句块，它逐行扫描文件，从第一行到最后一行重复这个过程，直到文件全部被读取完毕。</p>
<p>第三步：当读到输入流末尾时，执行end{action;…}语句块</p>
<p>BEGIN语句块在awk开始从输入流中读取行之前被执行，这是一个可选的语句块，比如变量初始化、打 印输出表格的表头等语句通常可以写在BEGIN语句块中 END语句块在awk从输入流中读取完所有的行之后即被执行，比如打印所有行的分析结果这类信息汇总 都是在END语句块中完成，它也是一个可选语句块</p>
<p>pattern语句块中的通用命令最重要的部分，也是可选的。如果没有提供pattern语句块，则默认执行{print}，即打印每一个读取到的行，awk读取的每一行都会执行该语句块</p>
<h3 id="分隔符、域、和记录"><strong>分隔符、域、和记录</strong></h3>
<ul>
<li>由分隔符分割的字段（列column,域field）标记$1,$2…$n称为域标识，$0为所有域，注意：和 shell中变量$符含义不同</li>
<li>文件的每一行称为记录record</li>
<li>如果省略action，则默认执行print $0 的操作</li>
</ul>
<h3 id="动作print"><strong>动作print</strong></h3>
<p>格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print item1,item2,...</span><br></pre></td></tr></table></figure>
<p>说明：</p>
<ul>
<li>逗号分隔符</li>
<li>输出item可以字符串，也可是数值；当前记录的字段、变量或awk的表达式</li>
<li>如省略item，相当于print $0</li>
<li>固定字符需要用 &quot;双引号&quot;引起来，而变量和数字不需要</li>
</ul>
<p>范例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# seq 3 |awk &#x27;&#123;print &quot;hello awk&quot;&#125;&#x27;</span><br><span class="line">hello awk</span><br><span class="line">hello awk</span><br><span class="line">hello awk</span><br><span class="line">[root@localhost ~]# seq 3 |awk &#x27;&#123;print 2*3&#125;&#x27;</span><br><span class="line">6</span><br><span class="line">6</span><br><span class="line">6</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">取出/etc/passwd中的用户和UID</span></span><br><span class="line">[root@localhost ~]# awk -F: &#x27;&#123;print $1,$3&#125;&#x27; /etc/passwd</span><br><span class="line">root 0</span><br><span class="line">bin 1</span><br><span class="line">daemon 2</span><br><span class="line">adm 3</span><br><span class="line">lp 4</span><br><span class="line">sync 5</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解释：-F: 是以:为分割点, <span class="variable">$1</span>和<span class="variable">$2</span>是该文件的第一和第三列,<span class="variable">$0</span>是代表全部</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">取出分区利用率</span></span><br><span class="line">[root@localhost ~]# df |awk &#x27;&#123;print $1,$5&#125;&#x27;</span><br><span class="line">文件系统 已用%</span><br><span class="line">devtmpfs 0%</span><br><span class="line">tmpfs 0%</span><br><span class="line">tmpfs 1%</span><br><span class="line">tmpfs 0%</span><br><span class="line">/dev/mapper/rl-root 7%</span><br><span class="line">/dev/nvme0n1p1 21%</span><br><span class="line">tmpfs 0%</span><br><span class="line">[root@localhost ~]# df |awk -F&quot; +|%&quot; &#x27;&#123;print $5&#125;&#x27;</span><br><span class="line">已用</span><br><span class="line">0</span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">0</span><br><span class="line">7</span><br><span class="line">21</span><br><span class="line">0</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">解释：-F后面可以跟多个分割条件(-F <span class="string">&quot; +|%&quot;</span>)的意思是以一个、多个空格或者%为分割条件</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">取IP地址</span></span><br><span class="line">[root@localhost ~]# hostname -I |awk &#x27; &#123;print $1&#125;&#x27; |cat -A</span><br><span class="line">192.168.1.10$</span><br><span class="line"></span><br><span class="line">文件host_list.log 如下格式，请提取”.zhang.com”前面的主机名部分并写入到回到该文件中</span><br><span class="line">[root@localhost ~]# cat host_list.log </span><br><span class="line">1 www.zhang.com</span><br><span class="line">2 blog.zhang.com</span><br><span class="line">3 study.zhang.com</span><br><span class="line">4 linux.zhang.com</span><br><span class="line">5 python.zhang.com</span><br><span class="line">www</span><br><span class="line">blog</span><br><span class="line">study</span><br><span class="line">linux</span><br><span class="line">python</span><br><span class="line">[root@localhost ~]# </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="awk变量">awk变量</h3>
<p>awk中的变量分为：内置变量和自定义变量</p>
<p><strong>常见的内置变量：</strong></p>
<ul>
<li>FS：输入字段分隔符，默认为空白字符，功能相当于 -F</li>
<li>OFS：输出字段分隔符，默认为空白字符</li>
<li>NF：字段数量</li>
<li>NR：记录的编号(行号来的)</li>
<li>FNR：各文件分别计数，记录的编号</li>
</ul>
<p><strong>例子</strong>：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">引用变量时，变量前不需要加$</span></span><br><span class="line">[root@localhost ~]# awk -F:  &#x27;&#123;print $1,$3&#125;&#x27; /etc/passwd</span><br><span class="line">root 0</span><br><span class="line">bin 1</span><br><span class="line">daemon 2</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">用FS变量可以让后面的输出有更多的选择性</span></span><br><span class="line">[root@localhost ~]# awk -v FS=&#x27;:&#x27;  &#x27;&#123;print $1,FS,$3&#125;&#x27; /etc/passwd</span><br><span class="line">root : 0</span><br><span class="line">bin : 1</span><br><span class="line">daemon : 2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">OFS让输出结果直接用什么表示</span></span><br><span class="line">[root@localhost ~]# awk -F: -v OFS=&#x27;++&#x27; &#x27;&#123;print $1,$3&#125;&#x27; /etc/passwd</span><br><span class="line">root++0</span><br><span class="line">bin++1</span><br><span class="line">daemon++2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">单NF表示这个字段有多少段，<span class="variable">$NF</span>表示最后一个字段</span></span><br><span class="line">[root@hhh ~]# awk -F: &#x27;&#123;print NF&#125;&#x27; /etc/passwd</span><br><span class="line">7</span><br><span class="line">7</span><br><span class="line">7</span><br><span class="line">[root@hhh ~]# awk -F: &#x27;&#123;print $NF&#125;&#x27; /etc/passwd</span><br><span class="line">/bin/bash</span><br><span class="line">/sbin/nologin</span><br><span class="line">[root@hhh ~]# netstat -nta|awk &#x27;&#123;print $NF&#125;&#x27;</span><br><span class="line">established)</span><br><span class="line">State</span><br><span class="line">LISTEN</span><br><span class="line">ESTABLISHED</span><br><span class="line">ESTABLISHED</span><br><span class="line">LISTEN</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">$(NF-2)表示该数据的倒数第二个字段</span></span><br><span class="line">[root@hhh ~]# netstat -nt |awk &#x27;&#123;print $(NF-2)&#125;&#x27;</span><br><span class="line">connections</span><br><span class="line">Foreign</span><br><span class="line">192.168.1.10:22</span><br><span class="line">192.168.1.10:22</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">查看/etc/passwd的行号</span></span><br><span class="line">[root@hhh ~]# awk &#x27;&#123;print NR&#125;&#x27; /etc/passwd</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">FNR分别统计行号</span></span><br><span class="line">[root@hhh ~]# awk &#x27;&#123;print FNR&#125;&#x27; /etc/issue /etc/hosts</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">1</span><br><span class="line">2</span><br></pre></td></tr></table></figure>
<p><strong>自定义变量</strong></p>
<p>自定义变量是区分字符大小写的，使用下面方式进行赋值</p>
<ul>
<li>
<p>-v var=value</p>
</li>
<li>
<p>在program中直接定义</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@hhh ~]# awk -v test1=test2=&quot;Hello,gawk&quot; &#x27;BEGIN&#123;print test1,test2&#125;&#x27;</span><br><span class="line">test2=Hello,gawk </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="动作printf">动作printf</h3>
<p>printf可以失效格式化输出</p>
<p><strong>格式：</strong></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">printf &quot;FORMAT&quot;,item1,item2,...</span><br></pre></td></tr></table></figure>
<p><strong>说明：</strong></p>
<ul>
<li>必须指定FORMAT</li>
<li>不会字段换行，需要显示给出换行控制符\n</li>
<li>FORMAT中需要分别为后面每个item指定格式符</li>
</ul>
<p><strong>格式符：与item–对应</strong></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">%s：显示字符串</span><br><span class="line">%d,%i：显示十进制整数</span><br><span class="line">%f：显示为浮点数</span><br><span class="line">%e,%E：显示科学计数发数值</span><br><span class="line">%c：显示字符的ASCII码</span><br><span class="line">%g,%G：以科学技术或浮点形式显示数值</span><br><span class="line">%u：无符合整数</span><br><span class="line">%%：显示%自身</span><br><span class="line"></span><br><span class="line">修饰符</span><br><span class="line">#[.#]	第一个数字控制显示的宽带：第二个#表示小数点后精确，如：%3.1f</span><br><span class="line">-		左对齐(默认右对齐) 如：%-15s</span><br><span class="line">+		显示数值的正负符号 如：%+d</span><br></pre></td></tr></table></figure>
<p><strong>案例：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">printf</span> <span class="string">&quot;%s\n&quot;</span>,<span class="variable">$1</span> <span class="variable">$1</span>的内容以字符串的形式显示并换行</span></span><br><span class="line">[root@hhh ~]# awk -F: &#x27;&#123;printf &quot;%s\n&quot;,$1&#125;&#x27; /etc/passwd</span><br><span class="line">root</span><br><span class="line">bin</span><br><span class="line">daemon</span><br><span class="line"></span><br><span class="line">[root@hhh ~]# awk -F: &#x27;&#123;printf &quot;%s %s\n&quot;,$1,$3&#125;&#x27; /etc/passwd</span><br><span class="line">root 0</span><br><span class="line">bin 1</span><br><span class="line">daemon 2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="variable">$1</span>的内容以左对齐显示20个字符换行的格式</span></span><br><span class="line">[root@hhh ~]# awk -F: &#x27;&#123;printf &quot;%-20s %5s\n&quot;,$1,$3&#125;&#x27; /etc/passwd</span><br><span class="line">root                     0</span><br><span class="line">bin                      1</span><br><span class="line">daemon                   2</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="操作符">操作符</h3>
<p>算术操作符：</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x+y,x-y,x*y,x/y,x^y,x%y</span><br><span class="line">-x：转换为负数</span><br><span class="line">+x：将字符串转换为数值</span><br></pre></td></tr></table></figure>
<p>字符串操作符：没有符合的操作符，字符串连接</p>
<p><strong>赋值操作符：</strong></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=,+=,-=,*=,/=,%=l,,^=,++,--</span><br></pre></td></tr></table></figure>
<p><strong>模式匹配符：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~	左边释放和右边匹配，包含关系</span><br><span class="line">!~	是否不匹配(不匹配)</span><br></pre></td></tr></table></figure>
<p><strong>案例：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">print</span> i++,i：是先打印i，然后再加。i++等于 i=i+1</span></span><br><span class="line">[root@hhh ~]# awk &#x27;BEGIN&#123;i=0;print i++,i&#125;&#x27;</span><br><span class="line">0 1</span><br><span class="line"></span><br><span class="line">[root@hhh ~]# seq 10 |awk &#x27;NR%2==0&#x27;</span><br><span class="line">2</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">8</span><br><span class="line">10</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="模式PATTERN">模式PATTERN</h3>
<p>PATTERN：根据pattern条件，过滤匹配的行，再做处理</p>
<ul>
<li>如果未指定：空模式，匹配每一行</li>
<li>/正则表达式 expression/：仅处理能够匹配到的行，需要/  /括起来</li>
<li>正则表达式：关系表达式，结果为 “真”才会被处理
<ul>
<li>真：结果为非0，非空字符串</li>
<li>假：结果为空字符串或0值</li>
</ul>
</li>
<li>行范围：不支持直接用行号，但可以使用变量NR间接指定行号。 /pat1/,/pat2/</li>
<li>BEGIN/END模式
<ul>
<li>BEGIN{}：仅在开始处理文件中的文本之前执行一次(用begin，后面可以不用跟文件名)</li>
<li>END{}：仅在文本处理完成之后执行一次</li>
</ul>
</li>
</ul>
<p>案例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">[root@hhh ~]# awk -F: &#x27;/^root/&#123;print $1&#125;&#x27; /etc/passwd</span><br><span class="line">root</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">取分区利用率</span></span><br><span class="line">[root@hhh ~]# df | awk -F&quot; +|%&quot; &#x27;/^\/dev/&#123;print $(NF-2)&#125;&#x27;</span><br><span class="line">7</span><br><span class="line">21</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">取本机IP</span></span><br><span class="line">[root@hhh ~]# ifconfig ens160 |awk &#x27;/netmask/&#123;print $2&#125;&#x27;</span><br><span class="line">192.168.1.10</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">取不是<span class="comment">#开头的行</span></span></span><br><span class="line">[root@hhh ~]# awk &#x27;!/^#/&#x27; /etc/fstab </span><br><span class="line"></span><br><span class="line">/dev/mapper/rl-root     /                       xfs     defaults        0 0</span><br><span class="line">UUID=31781593-b293-4d54-8104-7115b0f8c6d1 /boot                   xfs     defaults        0 0</span><br><span class="line">/dev/mapper/rl-swap     none                    swap    defaults        0 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@hhh ~]# seq 10 |awk &#x27;i=!i&#x27;</span><br><span class="line">1</span><br><span class="line">3</span><br><span class="line">5</span><br><span class="line">7</span><br><span class="line">9</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">解释：刚开始i没赋值所有为空，但取反了所以i=1，为真就把第一行打印了，第二次i=1,取反i=0,为假所以就不打印第二行</span></span><br><span class="line"></span><br><span class="line">[root@hhh ~]# seq 10 |awk &#x27;NR&gt;=3 &amp;&amp; NR&lt;=6&#x27;</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">/pat1/ /pat2/ 可以选择合适的范围进行过滤</span></span><br><span class="line">[root@hhh ~]# awk &#x27;/^r/,/^h/&#x27; /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="line">sync:x:5:0:sync:/sbin:/bin/sync</span><br><span class="line">shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1>shell</h1>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">-eq 等于</span><br><span class="line">-ne 不等于</span><br><span class="line">-gt 大于</span><br><span class="line">-ge 大于等于</span><br><span class="line">-lt 小于</span><br><span class="line">-le 小于等于</span><br></pre></td></tr></table></figure>
<p><strong>脚本调试:</strong></p>
<ul>
<li>语法错误，会导致后续的命令不继续执行，可以用bash -n 检查错误，提示的出错行数不一定是准 确的</li>
<li>命令错误，默认后续的命令还会继续执行，用bash -n 无法检查出来 ，可以使用 bash -x 进行观察</li>
<li>逻辑错误：只能使用 bash -x 进行观察</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> -A 检测文件的格式(文件中 $=空格)</span></span><br><span class="line">[root@hhh shell]# cat -A test.sh</span><br><span class="line">echo line1$</span><br><span class="line"><span class="meta prompt_">hostnam$</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="built_in">cat</span> &gt; test.txt &lt;&lt;<span class="string">EOF $</span></span></span><br><span class="line"><span class="meta prompt_">aaa$</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">bbb$</span></span></span><br><span class="line"><span class="meta prompt_">ccc$</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">EOF</span> $</span></span><br></pre></td></tr></table></figure>
<h2 id="变量">变量</h2>
<h3 id="命令要求">命令要求</h3>
<ul>
<li>区分大小写</li>
<li>不能使用程序中的保留字和内置变量：比如 if for while</li>
<li>只能使用数字、字母及下划线、且不能以数字开头</li>
</ul>
<p><strong>命令习惯</strong></p>
<ul>
<li>变量名大写、局部变量小写</li>
<li>函数名小写</li>
<li>大驼峰(每个单词首字母大写)和小驼峰</li>
<li>下划线</li>
</ul>
<p><strong>变量定义和引用</strong></p>
<p>变量的生效范围等标准划分变量类型，pstree命令查看shell进程</p>
<ul>
<li>
<p>普通变量：生效范围位仅当前shell进程，对其他和当前的子shell都无效</p>
</li>
<li>
<p>环境变量：生效范围位当前shell进程及其子进程</p>
</li>
<li>
<p>本地变量：本地变量：生效范围为当前shell进程中某代码片断，通常指函数</p>
</li>
</ul>
<p>弱引用和强引用</p>
<blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">name和<span class="string">&#x27;$name&#x27;</span>的区别</span> </span><br><span class="line">[root@hhh shell]# echo $name</span><br><span class="line">zhang</span><br><span class="line">[root@hhh shell]# echo &#x27;$name&#x27;</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">name</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="运算相关">运算相关</h2>
<h3 id="算数运算">算数运算</h3>
<p>bash只支持整数，不支持小数</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">实现算数运算</span></span><br><span class="line">(1) let var=算术表达式</span><br><span class="line">(2) ((var=算术表达式)) 和上面等价</span><br><span class="line">(3) var=[算术表达式]</span><br><span class="line">(4) var=((算术表达式))</span><br><span class="line">(5) var=$(expr arg1 arg2 arg3 ...)</span><br><span class="line">(6) declare -i var = 数值</span><br><span class="line">(7) echo &#x27;算术表达式&#x27; | bc </span><br></pre></td></tr></table></figure>
<p><strong>增强型赋值：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+= i+=10	#相当于 i=i+10</span><br><span class="line">-= i-=j		#相当于 i=i-j</span><br><span class="line">++ i++,++i	#相当于 i=i+1</span><br><span class="line">-- i-- i--	#相当于 i=i-1</span><br></pre></td></tr></table></figure>
<p>内建的随机数生成器变量：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">RANDOM	取值范围:0-32767</span></span><br></pre></td></tr></table></figure>
<p>范例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">生成0--49之间随机数</span></span><br><span class="line">[root@hhh ~]# echo $[$RANDOM%50]</span><br><span class="line">34</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">随机字体颜色</span></span><br><span class="line">[root@centos8 ~]#echo -e &quot;\033[1;$[RANDOM%7+31]mhello\033[0m&quot;</span><br><span class="line">magedu</span><br></pre></td></tr></table></figure>
<h3 id="逻辑运算">逻辑运算</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">true,false</span><br><span class="line">1 真</span><br><span class="line">0 假</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">与: &amp;: 准则就是一假全假，全真才真</span></span><br><span class="line">0 与 0 = 0</span><br><span class="line">0 与 1 = 0</span><br><span class="line">1 与 0 = 0</span><br><span class="line">1 与 1 = 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">或: | : 一真则真,全假才假</span></span><br><span class="line">0 或 0 = 0</span><br><span class="line">0 或 1 = 1</span><br><span class="line">1 或 0 = 1</span><br><span class="line">1 或 1 = 1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">非: ! : 取相反</span></span><br><span class="line">! 1 = 0   !  true</span><br><span class="line">! 0 = 1 !  false</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">异或: ^  相同为假，不同为真</span></span><br><span class="line">0 ^ 0 = 0</span><br><span class="line">0 ^ 1 = 1</span><br><span class="line">1 ^ 0 = 1</span><br><span class="line">1 ^ 1 = 0</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="短路运算">短路运算</h3>
<p>用的最多：</p>
<blockquote>
<p><font color='red'>CMD1 &amp;&amp; CMD2 || CMD3</font></p>
<ul>
<li>
<p>短路与 和 或组合</p>
<p>当CMD1执行成功时,会执行CMD2</p>
<p>当CMD1执行失败时,会执行CMD3</p>
<p>注意： CMD1 || CMD2 &amp;&amp; CMD3 逻辑不通,不使用</p>
</li>
</ul>
</blockquote>
<ul>
<li>
<p>短路与	&amp;&amp;</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CMD1 &amp;&amp; CMD2</span><br><span class="line">第一个CMD1结果为真(1)，第二个CMD2必须要参与运算，才能得到最终的结果</span><br><span class="line">第一个CMD1结果为假(0)，总的结果必定为0，因此不需要执行CMD2</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>短路或    ||</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CMD1 || CMD2</span><br><span class="line">第一个CMD1结果为真(1)，总的结果必定为1，因此不需要执行CMD2</span><br><span class="line">第一个CMD1结果为假(0)，第二个CMD2 必须要参与运算,才能得到最终的结果</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="条件测试">条件测试</h2>
<p>条件测试命令：</p>
<ul>
<li>test</li>
<li>[ ]#和test等价，建议使用[ ]</li>
<li>[[ ]] 增强版的[ ]，支持[ ]的用法且支持扩展正则表达式和通配符</li>
</ul>
<p><strong>注意：在中括号和花括号{}里，左右两边必须要有空格</strong>，要使用正则或通配符使用[[ ]]</p>
<p><strong>字符串测试</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">test</span>和[ ] 字符串测试用法：</span></span><br><span class="line">-z	#字符串是否为空，空为0不空1</span><br><span class="line">-n	#字符串是否不空，不空1空0</span><br><span class="line">string1 = string2 #是否相等，前后有空格</span><br><span class="line">!=	不等于 </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">[[]]字符串测试用法：</span></span><br><span class="line">== 左侧字符串是否和右侧的PATTERN相同</span><br><span class="line"> 注意:此表达式用于[[ ]]中，PATTERN为通配符</span><br><span class="line">=~ 左侧字符串是否能够被右侧的正则表达式的PATTERN所匹配</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">注意: 此表达式用于[[ ]]中为扩展的正则表达式</span></span><br></pre></td></tr></table></figure>
<p>范例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@hhh ~]# echo $?</span><br><span class="line">0</span><br><span class="line">[root@hhh ~]# str=&quot;&quot;</span><br><span class="line">[root@hhh ~]# echo $?</span><br><span class="line">0</span><br><span class="line">[root@hhh ~]# [ -z &quot;str&quot; ]</span><br><span class="line">[root@hhh ~]# echo $?</span><br><span class="line">1</span><br><span class="line">[root@hhh ~]# [ -n &quot;str&quot; ]</span><br><span class="line">[root@hhh ~]# echo $?</span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">[root@hhh ~]# str1=hhh</span><br><span class="line">[root@hhh ~]# str2=lll</span><br><span class="line">[root@hhh ~]# [ $str1 = $str2 ]</span><br><span class="line">[root@hhh ~]# echo $?</span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">[root@hhh ~]# name=linux1</span><br><span class="line">[root@hhh ~]# [[ &quot;$name&quot; == linux* ]]</span><br><span class="line">[root@hhh ~]# echo $?</span><br><span class="line">0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">判断合法IP</span></span><br><span class="line">[root@centos8 ~]#IP=1.2.3.4</span><br><span class="line">[root@centos8 ~]#[[ &quot;$IP&quot; =~ ^([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;$ ]]</span><br><span class="line">[root@centos8 ~]#echo $?</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<h2 id="文件测试">文件测试</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">存在性测试</span></span><br><span class="line">-e或-a 存在为真，否则为假(一般用-e)</span><br><span class="line">-b 是否存在且为块设备文件</span><br><span class="line">-c 是否存在且为字符设备文件</span><br><span class="line">-d 是否存在且为目录文件</span><br><span class="line">-f 是否存在且为普通文件</span><br><span class="line">-h或-L：存在且为符号链接文件</span><br><span class="line">-p 是否存在且为命令管道文件</span><br><span class="line">-s 是否存在且为套接字</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">文件权限测试(不熟):</span></span><br><span class="line">-r FILE：是否存在且可读</span><br><span class="line">-w FILE: 是否存在且可写</span><br><span class="line">-x FILE: 是否存在且可执行</span><br><span class="line">-u FILE：是否存在且拥有suid权限</span><br><span class="line">-g FILE：是否存在且拥有sgid权限</span><br><span class="line">-k FILE：是否存在且拥有sticky权限</span><br><span class="line">注意：最终结果由用户对文件的实际权限决定，而非文件属性决定</span><br></pre></td></tr></table></figure>
<h2 id="关于-和">关于( )和{ }</h2>
<blockquote>
<p>小括号()：会开启子shell,并且list中变量赋值及内部命令执行后,将不再影响后续的环境</p>
<p>花括号{}： 不会启子shell, 在当前shell中运行,会影响当前shell环境</p>
<p><font color='red'>注意：使用中括号和花括号两边要留空格</font></p>
</blockquote>
<p>范例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@hhh ~]# name=zhang;(echo $name;name=wang;echo $name);echo $name</span><br><span class="line">zhang</span><br><span class="line">wang</span><br><span class="line">zhang</span><br><span class="line">[root@hhh ~]# name=li;&#123; echo $name;name=huang;echo $name; &#125;;echo $name </span><br><span class="line">li</span><br><span class="line">huang</span><br><span class="line">huang</span><br></pre></td></tr></table></figure>
<h2 id="read">read</h2>
<p>shell中的read命令等同于python里的input</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">常见选项：</span></span><br><span class="line">-p	指定要显示的提示</span><br><span class="line">-s	静默输入，一般用于密码</span><br><span class="line">-n	指定输入的字符长度为N个</span><br><span class="line">-d &#x27;结束符&#x27;	输入结束符</span><br><span class="line">-t	timeout为N秒</span><br></pre></td></tr></table></figure>
<h2 id="shell的配置文件">shell的配置文件</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">vim .vimrc vim的个人配置文件</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">全局配置：针对所有用户皆有效</span></span><br><span class="line">/etc/profile</span><br><span class="line">/etc/profile.d/*.sh</span><br><span class="line">/etc/bashrc</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">个人配置：只针对特定用户有效</span></span><br><span class="line">~/.bash_profile</span><br><span class="line">~/.bashrc</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">修改文件后生效两种方法：</span></span><br><span class="line">1、重启shell进程</span><br><span class="line">2、source</span><br></pre></td></tr></table></figure>
<h2 id="if">if</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">单分支</span></span><br><span class="line">if 判断条件;then</span><br><span class="line">	条件为真的分支代码</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">双分支</span></span><br><span class="line">if 判断条件;then</span><br><span class="line">	条件为真的分支代码</span><br><span class="line">else</span><br><span class="line">	条件为假的分支代码</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">多分支</span></span><br><span class="line">if 判断条件1;thne</span><br><span class="line">	条件1为真的分支代码</span><br><span class="line">elif 判断条件2; then</span><br><span class="line"> 	条件2为真的分支代码</span><br><span class="line">elif 判断条件3; then</span><br><span class="line"> 	条件3为真的分支代码</span><br><span class="line">……</span><br><span class="line">else</span><br><span class="line"> 以上条件都为假的分支代码</span><br><span class="line">fi</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">注意：多个条件时，主管条件进行判断，第一次遇为<span class="string">&quot;真&quot;</span>条件时，主席其分支，而后结束整个<span class="keyword">if</span>语句，<span class="keyword">if</span>语句可嵌套</span></span><br></pre></td></tr></table></figure>
<h2 id="while">while</h2>
<h2 id="脚本工具">脚本工具</h2>
<h3 id="expect">expect</h3>
<p>expect 是交互式转化批处理工具 expect，借助expect处理交互的命令，可以将交互过程如：ssh登录，ftp登录等写在一个脚本上，使之自动化完成。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装expect及mkpasswd工具</span></span><br><span class="line">[root@localhost ~]# yum -y install expect</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">mkpasswd是自动生成密码，如: -l 是生成几位数, -d 是几个数字， -C 是几个大写字母</span></span><br><span class="line">[root@localhost ~]# mkpasswd  -l 16 -d 4 -C 6</span><br><span class="line">J0tJ667tHIhtgTM&#123;</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">expect用法：</span></span><br><span class="line">选项：</span><br><span class="line">	-c	从命令行执行expect脚本，默认expect是交互地执行的</span><br><span class="line">	-d	可以调试信息</span><br><span class="line">相关命令：</span><br><span class="line">-spawn	启动新的进程</span><br><span class="line">-expect	从进程接收字符串</span><br><span class="line">-send	用于向进程发送字符串</span><br><span class="line">-interact	允许用户交互</span><br><span class="line">-exp_continue 匹配多个字符串在执行动作后加此命令</span><br></pre></td></tr></table></figure>
<p><strong>案例：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">单分支语法</span></span><br><span class="line">[root@localhost ~]# expect </span><br><span class="line">expect1.1&gt; expect &quot;hi&quot; &#123;send &quot;You said hi\n&quot;&#125;</span><br><span class="line">hahahixixi</span><br><span class="line">You said hi</span><br><span class="line">匹配到hi后，会输出“you said hi”，并换行</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">shell中调用expect</span></span><br><span class="line">[root@localhost ~]# vim expect1.sh</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">ip=$1</span><br><span class="line">user=$2</span><br><span class="line">password=$3</span><br><span class="line">expect &lt;&lt;EOF</span><br><span class="line">set timeout 20</span><br><span class="line">spawn ssh $user@$ip</span><br><span class="line">expect &#123;</span><br><span class="line">        &quot;yes/no&quot; &#123; send &quot;yes\n&quot;;exp_continue &#125;</span><br><span class="line">        &quot;password&quot; &#123; send &quot;$password\n&quot; &#125;</span><br><span class="line">&#125;</span><br><span class="line">expect &quot;]#&quot; &#123; send &quot;useradd jjj\n&quot; &#125;</span><br><span class="line">expect &quot;]#&quot; &#123; send &quot;echo magedu |passwd --stdin hehe\n&quot; &#125;</span><br><span class="line">expect &quot;]#&quot; &#123; send &quot;exit\n&quot; &#125;</span><br><span class="line">expect eof</span><br><span class="line">EOF</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">: shell脚本利用循环调用expect在CentOS和Ubuntu上批量创建用户</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/basjh</span></span><br><span class="line">NET=10.0.0</span><br><span class="line">user=root</span><br><span class="line">password=magedu</span><br><span class="line">IPLIST=&quot;</span><br><span class="line">范例：</span><br><span class="line">7</span><br><span class="line">18</span><br><span class="line">101</span><br><span class="line">&quot;</span><br><span class="line">for ID in $IPLIST;do</span><br><span class="line">ip=$NET.$ID</span><br><span class="line">expect &lt;&lt;EOF</span><br><span class="line">set timeout 20</span><br><span class="line">spawn ssh $user@$ip</span><br><span class="line">expect &#123;</span><br><span class="line">        &quot;yes/no&quot; &#123; send &quot;yes\n&quot;;exp_continue &#125;</span><br><span class="line">        &quot;password&quot; &#123; send &quot;$password\n&quot; &#125;</span><br><span class="line">&#125;</span><br><span class="line">expect &quot;#&quot; &#123; send &quot;useradd test\n&quot; &#125;</span><br><span class="line">expect &quot;#&quot; &#123; send &quot;exit\n&quot; &#125;</span><br><span class="line">expect eof</span><br><span class="line">EOF</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h2 id="数组">数组</h2>
<p>变量：存储单个元素的内存空间</p>
<p>数组：存储多个元素的连续的内存空间，相当于多个变量的集合</p>
<p>数组名和索引：</p>
<ul>
<li>索引的编号是从0开始，属于数值索引</li>
<li>索引可支持使用自定义的格式，而不是数值格式，即为关联索引.</li>
<li>bash的输出支持稀疏格式(索引不连续)</li>
</ul>
<p><strong>声明数组：</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">普通数组可以不事先声明，直接使用</span></span><br><span class="line">declare -a ARRAY_NAME</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">关联数组必须先声明，再使用</span></span><br><span class="line">declare -A ARRAY_NAME</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">注意:两者不可相互转换</span></span><br></pre></td></tr></table></figure>
<h2 id="总结">总结</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">bash -n #检查脚本语法错误</span><br><span class="line">bash -x #检查脚本命令错误和逻辑错误</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">name和<span class="string">&#x27;$name&#x27;</span>的区别</span></span><br><span class="line">三种变量的生效范围</span><br><span class="line">pstree命令 #查看bash中的进程关系</span><br><span class="line">set #显示已定义的所有变量 unset删除</span><br><span class="line">printf #增强版的echo，实现丰富的格式化输出</span><br><span class="line">条件测试</span><br><span class="line">()和&#123;&#125;的区别</span><br><span class="line">read等同于python里的input</span><br></pre></td></tr></table></figure>
<h1>磁盘和存储管理</h1>
<p>给虚拟机添加磁盘出的问题记录：添加SCSI硬盘重启会重装系统</p>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211161055602.png" alt="image-20221013092907752"></p>
<p>总结：原来虚拟机是硬盘是nvme，添加SCSI硬盘会导致系统重装，</p>
<p>解决方法：在BIOS界面调整磁盘引导顺序</p>
<h2 id="分区方式"><strong>分区方式</strong></h2>
<p>两种分区方式：<font color='red'>MBR、GPT</font></p>
<p>MBR：Master Boot Record，1982年，使用32位表示扇区数，分区不超过2T</p>
<p>MBR分区中一块硬盘最多有4个主分区，也可以3主分区+1扩展(N个逻辑分区) MBR分区：主和扩展分区对应的1–4，/dev/sda3，逻辑分区从5开始，/dev/sda5</p>
<p>GPT：GUID（Globals Unique Identifiers） partition table 支持128个分区，使用64位，支持8Z（ 512Byte/block ）64Z （ 4096Byte/block）</p>
<p><strong>管理分区</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">列出块设备</span></span><br><span class="line">[root@hhh ~]# lsblk </span><br><span class="line">NAME        MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sda           8:0    0    2G  0 disk </span><br><span class="line">└─sda1        8:1    0    2G  0 part </span><br><span class="line">sr0          11:0    1 10.5G  0 rom  </span><br><span class="line">nvme0n1     259:0    0   40G  0 disk </span><br><span class="line">├─nvme0n1p1 259:1    0    1G  0 part /boot</span><br><span class="line">└─nvme0n1p2 259:2    0   39G  0 part </span><br><span class="line">  ├─rl-root 253:0    0   37G  0 lvm  /</span><br><span class="line">  └─rl-swap 253:1    0    2G  0 lvm  [SWAP]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建分区命令</span></span><br><span class="line">fdisk 管理MBR分区</span><br><span class="line">gdisk 管理GPT分区</span><br><span class="line">parted 高级分区操作，可以是交互或非交互方式(小心使用)</span><br></pre></td></tr></table></figure>
<p><strong>分区工具fdisk和gdisk</strong></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l [-u] [device...]     查看分区</span><br><span class="line">fdisk [device...]             管理MBR分区</span><br><span class="line">gdisk [device...]             类fdisk 的GPT分区工具</span><br><span class="line"></span><br><span class="line">#子命令：pnw</span><br><span class="line">p 分区列表</span><br><span class="line">t 更改分区类型</span><br><span class="line">n 创建新分区</span><br><span class="line">d 删除分区</span><br><span class="line">v 校验分区</span><br><span class="line">u 转换单位</span><br><span class="line">w 保存并退出</span><br><span class="line">q 不保存并退出</span><br></pre></td></tr></table></figure>
<h2 id="文件系统类型">文件系统类型</h2>
<p><strong>常见的文件系统类型</strong></p>
<ul>
<li>ext4：是 ext 文件系统的最新版。提供了很多新的特性，包括纳秒级时间戳、创建和使用巨型文件 (16TB)、最大1EB的文件系统，以及速度的提升</li>
<li>xfs：SGI，支持最大8EB的文件系统</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Windows 常用文件系统</span></span><br><span class="line">FAT32 、NTFS、exFAT</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Unix：</span></span><br><span class="line">FFS（fast） 、UFS（unix）、 JFS2 </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">网络文件系统：</span></span><br><span class="line">NFS、CIFS</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">集群文件系统：</span></span><br><span class="line">GFS2、OCFS2（oracle）</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">分布式文件系统：fastdfs</span></span><br><span class="line">ceph、moosefs、mogilefs、glusterfs、Lustre</span><br></pre></td></tr></table></figure>
<p><strong>创建文件系统 mkfs</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mkfs命令选项：</span></span><br><span class="line">-t &#123;ext2|ext3|ext4|xfs&#125; 指定文件系统类型</span><br><span class="line">-b &#123;1024|2048|4096&#125; 指定块 block 大小</span><br><span class="line">-L ‘LABEL’ 设置卷标</span><br><span class="line">-j 相当于 -t ext3， mkfs.ext3 = mkfs -t ext3 = mke2fs -j = mke2fs -t ext3</span><br><span class="line">-i  # 为数据空间中每多少个字节创建一个inode；不应该小于block大</span><br><span class="line">小</span><br><span class="line">-N  # 指定分区中创建多少个inode</span><br><span class="line">-I 一个inode记录占用的磁盘空间大小，128---4096</span><br><span class="line">-m  # 默认5%,为管理人员预留空间占总空间的百分比</span><br><span class="line">-O FEATURE[,...] 启用指定特性</span><br><span class="line">-O ^FEATURE 关闭指定特性</span><br><span class="line"></span><br><span class="line">[root@hhh ~]# mkfs.</span><br><span class="line">mkfs.cramfs  mkfs.ext3    mkfs.minix   </span><br><span class="line">mkfs.ext2    mkfs.ext4    mkfs.xfs </span><br><span class="line">[root@hhh ~]# mkfs.ext4 /dev/sda </span><br><span class="line">mke2fs 1.45.6 (20-Mar-2020)</span><br><span class="line"> /dev/sda 有一个 ext4 文件系统</span><br><span class="line">	上一次挂载于Thu Oct 13 11:08:34 2022</span><br><span class="line">Proceed anyway? (y,N) n</span><br></pre></td></tr></table></figure>
<p><strong>查看和管理分区信息 blkid</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">blkid 可以查看块设备属性信息</span></span><br><span class="line">[root@hhh ~]# blkid /dev/sda </span><br><span class="line">/dev/sda: UUID=&quot;b70ff07c-88a5-44a6-80a7-d1d3b5948945&quot; BLOCK_SIZE=&quot;4096&quot; TYPE=&quot;ext4&quot;</span><br></pre></td></tr></table></figure>
<h2 id="挂载">挂载</h2>
<p>挂载(mount)：将额外文件系统与根文件系统某现存的目录建立起关联关系，进而使得此目录做为其它文件访问入 口的行为</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">mount 常用命令选项</span></span><br><span class="line">-t fstype 指定要挂载的设备上的文件系统类型,如:ext4,xfs</span><br><span class="line">-r readonly，只读挂载</span><br><span class="line">-w read and write, 读写挂载,此为默认设置,可省略</span><br><span class="line">-n 不更新/etc/mtab，mount不可见</span><br><span class="line">-a 自动挂载所有支持自动挂载的设备(定义在了/etc/fstab文件中，且挂载选项中有</span><br><span class="line">auto功能)</span><br><span class="line">-L &#x27;LABEL&#x27; 以卷标指定挂载设备</span><br><span class="line">-U &#x27;UUID&#x27; 以UUID指定要挂载的设备</span><br><span class="line">-B, --bind 绑定目录到另一个目录上</span><br></pre></td></tr></table></figure>
<p><strong>挂载规则</strong>：</p>
<ul>
<li>一个挂载点同一时间只能挂载一个设备</li>
<li>一个挂载点同一时间挂载了多个设备，只能看到最后一个设备的数据，其它设备上的数据将被隐藏</li>
<li>一个设备可以同时挂载到多个挂载点</li>
<li>通常挂载点一般是已存在空的目录</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">umount：可卸载设备和挂载点</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">df</span>：查看挂载情况</span></span><br></pre></td></tr></table></figure>
<h2 id="永久挂载">永久挂载</h2>
<p>将挂载保存到<font color='red'> /etc/fstab</font> 中可以下次开机时，自动启用挂载</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">设备名可以 <span class="built_in">df</span>查看    UUID用blkid查看</span></span><br><span class="line">[root@hhh ~]# vim /etc/fstab</span><br><span class="line">UUID=b70ff07c-88a5-44a6-80a7-d1d3b5948945 /mnt/ ext4 defaults 0 0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">每行定义一个要挂载的文件系统,，其中包括共 6 项</span></span><br><span class="line">要挂载的设备或伪文件系统</span><br><span class="line">1、设备文件</span><br><span class="line"> LABEL：LABEL=&quot;&quot;</span><br><span class="line"> UUID：UUID=&quot;&quot;</span><br><span class="line"> 伪文件系统名称：proc, sysfs</span><br><span class="line">2、挂载点：必须是事先存在的目录</span><br><span class="line">3、文件系统类型：ext4，xfs，iso9660，nfs，none</span><br><span class="line">4、挂载选项：defaults ，acl，bind，设置挂载设备的权限一般不用</span><br><span class="line">5、转储频率：0：不做备份 1：每天转储 2：每隔一天转储</span><br><span class="line">6、fsck检查的文件系统的顺序：允许的数字是0 1 2</span><br><span class="line">	o：不自检 ，1：首先自检；一般只有rootfs才用 2：非rootfs使用</span><br><span class="line"><span class="meta prompt_">	</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加新的挂载项，想要立即生效使用：</span></span><br><span class="line">mount -a</span><br></pre></td></tr></table></figure>
<h2 id="swap交换分区">swap交换分区</h2>
<p>swap的作用：当内存不够时，会使用swap，但使用swap会影响性能，部署k8时会禁用掉，(用的很少，所有会禁用就行了）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">禁用两个方法：</span></span><br><span class="line">swapoff + 设备名；</span><br><span class="line">永久禁用进配置文件注释掉</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">先查看swap的名称</span></span><br><span class="line">[root@hhh ~]# swapon -s</span><br><span class="line">文件名				类型		大小	已用	权限</span><br><span class="line">/dev/dm-1                              	partition	2125820	0	-2</span><br><span class="line">[root@hhh ~]# free -h</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:          1.7Gi       211Mi       1.3Gi       8.0Mi       225Mi       1.4Gi</span><br><span class="line">Swap:         2.0Gi          0B       2.0Gi</span><br><span class="line">[root@hhh ~]# swapoff /dev/dm-1 </span><br><span class="line">[root@hhh ~]# free -h</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:          1.7Gi       210Mi       1.3Gi       8.0Mi       224Mi       1.4Gi</span><br><span class="line">Swap:            0B          0B          0B</span><br></pre></td></tr></table></figure>
<h2 id="dd-磁盘测试工具">dd 磁盘测试工具</h2>
<p>(暂时不学)</p>
<h2 id="RAID">RAID</h2>
<p>独立硬盘冗余阵列，简称磁盘阵列(RAID)</p>
<p><strong>RAID0</strong></p>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211161056798.png" alt="image-20221014102814375"></p>
<ul>
<li>
<p>优点：<font color='red'>RAID0具有低成本、高读写性能、100%的高存储空间利用率</font></p>
</li>
<li>
<p>缺点：没冗余，数据丢了就丢了</p>
</li>
</ul>
<blockquote>
<p>总结：<font color='red'>读写性能提升、利用率100%、最少两块硬盘</font>(实际一块也行，但没必要)</p>
<p>一般适用于对性能要求严格但对数据安全性和可靠性不高的应用，如视频、音频存储、临时数据缓存空间等</p>
</blockquote>
<p>**RAID1<img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211161057420.png" alt="image-20221014102827087"></p>
<p>RAID0称为镜像</p>
<ul>
<li>优点：能备份数据</li>
<li>缺点：贵、写入会受影响、读会有点提升</li>
</ul>
<blockquote>
<p>总结：读有提示，写会受影响，磁盘利用率50%，最少两块</p>
<p>应用于对顺序读写性能要求高以及对数据保护极为重视的应用，如对邮件系统的数据保护。</p>
</blockquote>
<p>**RAID4<img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211161057386.png" alt="image-20221014104145629"></p>
<p>RAID4与RAID3的区别在于<font color='red'>条带化的方式不同</font>，RAID3是位校验的数据条带而RAID4是按照块的方式来组织数据，可以保证单块的完整性，可以避免受到其他磁盘上同条带产生的不利影响。</p>
<blockquote>
<p>Ap=A1+A2+A3<br>
假如A1坏了，就可以用校验盘Disk3把A1修复:A1=Ap-A2-A3</p>
<p>总结：(不常用)<br>
多块数据盘异或运算值存于专用校验盘<br>
<font color='red'>磁盘利用率 (N-1)/N、有冗余能力、至少3块硬盘才可以实现</font></p>
<p>RAID4校验盘坏的几率比数据盘的大,所有用的很少</p>
</blockquote>
<p><strong>RAID5</strong></p>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211161605299.png" alt="image-20221014105446471"></p>
<p>RAID5 应该是目前最常见的</p>
<blockquote>
<p>读、写性能提升<br>
磁盘利用率： (n-1)/n<br>
有容错能力：允许最多1块磁盘损坏<br>
最少磁盘数：3, 3+</p>
</blockquote>
<p><strong>RAID6</strong></p>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211161058372.png" alt="image-20221014110351518"></p>
<p>RAID5的升级版，比RAID5多了一块校验盘</p>
<blockquote>
<p>双份校验位,算法更复杂<br>
读、写性能提升<br>
磁盘利用率：(n-2)/n<br>
有容错能力：允许最多2块磁盘损坏<br>
最少磁盘数：4, 4+</p>
</blockquote>
<p><strong>RAID-01和RAID-10</strong></p>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211161058285.png" alt="image-20221014110629637"></p>
<blockquote>
<p>读、写性能提升<br>
磁盘利用率：50%<br>
有容错能力：每组镜像最多只能坏一块<br>
最少磁盘数：4, 4+</p>
<p>RAID-01：多块磁盘先实现RAID0，在组合成RAID1</p>
</blockquote>
<p><strong>RAID-50</strong></p>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211161059194.png" alt="image-20221014111111348"></p>
<p>多块磁盘先实现RAID5，再组合成RAID0</p>
<p><strong>JBOD</strong></p>
<p>只是一堆磁盘(家用)，功能：将多块磁盘的空间合并一个大的使用</p>
<p><strong>RAID总结：</strong></p>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211161059233.png" alt="image-20221014111829551"></p>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211161059468.png" alt="image-20221014111842284"></p>
<h2 id="逻辑卷管理-LVM">逻辑卷管理(LVM)</h2>
<p>​	   VM是逻辑卷管理的简称，它是建立再物理内存设备之上的一个抽象层，允许你生成逻辑存储卷，与直接使用物理内存在管理上相比，提高更好灵活性</p>
<blockquote>
<p>LVM与直接使用物理存储相比,有以下优点:<br>
1、灵活的容量.<br>
当使用逻辑卷时,文件系统可以扩展到多个磁盘上,你可以聚合多个磁盘或磁盘分区成单一的逻辑卷.<br>
2、可伸缩的存储池.<br>
可以使用简单的命令来扩大或缩小逻辑卷大小,不用重新格式化或分区磁盘设备.<br>
3、在线的数据再分配.<br>
可以在线移动数据,数据可以在磁盘在线的情况下重新分配.比如,你可以在线更换可热插拔的磁盘.<br>
4、方便的设备命名<br>
逻辑卷可以按你觉得方便的方式来起任何名称.<br>
5、磁盘条块化.<br>
可以生成一个逻辑盘,它的数据可以被条块化存储在2个或更多的磁盘上.这样可以明显提升数据吞吐量.<br>
6、镜像卷<br>
逻辑卷提供方便的方法来镜像你的数据.<br>
7、卷快照<br>
使用逻辑卷,你可以获得设备快照用来一致性备份或者测试数据更新效果而不影响真实数据.</p>
</blockquote>
<p><strong>创建和管理LVM</strong></p>
<p>逻辑卷的基本组成</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1、物理卷(PV):一个可存储LVM的块设备如硬盘分区(MBR,GPT分区)</span><br><span class="line">2、卷组(VG):卷组是对一个或多个物理卷的集合</span><br><span class="line">3、逻辑卷(LV):是可提供系统使用的最终元设备，在卷组中创建和管理，有物理块组成，实际就是一个虚拟分区</span><br><span class="line">4、物理块(PE):一个卷组中最新的连续分区(默认未4MB)，多个物理块将被分配给一个逻辑卷</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">vgcreat -s 16  testvg0 /dev/sd&#123;a1,b&#125;</span></span><br><span class="line">-s就是修改PE的大小</span><br></pre></td></tr></table></figure>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211161059908.png" alt="image-20221014114636480"></p>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211161101343.png" alt="image-20221017100159822"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">创建逻辑卷之前要先分好区</span></span><br><span class="line">[root@hhh ~]# lsblk </span><br><span class="line">NAME        MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sda           8:0    0    2G  0 disk </span><br><span class="line">sdb           8:16   0    2G  0 disk </span><br><span class="line">sr0          11:0    1 10.5G  0 rom  </span><br><span class="line">nvme0n1     259:0    0   40G  0 disk </span><br><span class="line">├─nvme0n1p1 259:1    0    1G  0 part /boot</span><br><span class="line">└─nvme0n1p2 259:2    0   39G  0 part </span><br><span class="line">  ├─rl-root 253:0    0   37G  0 lvm  /</span><br><span class="line">  └─rl-swap 253:1    0    2G  0 lvm  [SWAP]</span><br><span class="line">[root@hhh ~]# fdisk /dev/sda</span><br><span class="line">n p t(更改硬盘ID) 8e</span><br><span class="line">命令(输入 m 获取帮助)：t</span><br><span class="line">已选择分区 1</span><br><span class="line">Hex 代码(输入 L 列出所有代码)：8e</span><br><span class="line">已将分区“Linux”的类型更改为“Linux LVM”。</span><br><span class="line">[root@hhh ~]# lsblk </span><br><span class="line">NAME        MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sda           8:0    0    2G  0 disk </span><br><span class="line">└─sda1        8:1    0    2G  0 part </span><br><span class="line">sdb           8:16   0    2G  0 disk </span><br><span class="line">sr0          11:0    1 10.5G  0 rom  </span><br><span class="line">nvme0n1     259:0    0   40G  0 disk </span><br><span class="line">├─nvme0n1p1 259:1    0    1G  0 part /boot</span><br><span class="line">└─nvme0n1p2 259:2    0   39G  0 part </span><br><span class="line">  ├─rl-root 253:0    0   37G  0 lvm  /</span><br><span class="line">  └─rl-swap 253:1    0    2G  0 lvm  [SWAP]</span><br><span class="line"></span><br><span class="line">1、#用PV命令将硬盘变为物理卷</span><br><span class="line">[root@hhh ~]# pvcreate /dev/sd&#123;a1,b&#125;</span><br><span class="line">  Physical volume &quot;/dev/sda1&quot; successfully created.</span><br><span class="line">  Physical volume &quot;/dev/sdb&quot; successfully created.</span><br><span class="line">[root@hhh ~]# pvs</span><br><span class="line">  PV             VG Fmt  Attr PSize   PFree </span><br><span class="line">  /dev/nvme0n1p2 rl lvm2 a--  &lt;39.00g     0 </span><br><span class="line">  /dev/sda1         lvm2 ---   &lt;2.00g &lt;2.00g</span><br><span class="line">  /dev/sdb          lvm2 ---    2.00g  2.00g</span><br><span class="line"></span><br><span class="line">2、#用VG把物理卷变成物理卷组</span><br><span class="line">[root@hhh ~]# vgs</span><br><span class="line">  VG #PV #LV #SN Attr   VSize   VFree</span><br><span class="line">  rl   1   2   0 wz--n- &lt;39.00g    0 </span><br><span class="line">[root@hhh ~]# vgcreate testvg0 /dev/sd&#123;a1,b&#125;</span><br><span class="line">  Volume group &quot;testvg0&quot; successfully created</span><br><span class="line">[root@hhh ~]# pvs</span><br><span class="line">  PV             VG      Fmt  Attr PSize   PFree </span><br><span class="line">  /dev/nvme0n1p2 rl      lvm2 a--  &lt;39.00g     0 </span><br><span class="line">  /dev/sda1      testvg0 lvm2 a--   &lt;2.00g &lt;2.00g</span><br><span class="line">  /dev/sdb       testvg0 lvm2 a--   &lt;2.00g &lt;2.00g</span><br><span class="line"></span><br><span class="line">3、#用LV在物理卷组中分成一块空间来就是物理卷</span><br><span class="line">[root@hhh ~]# lvs</span><br><span class="line">  LV   VG Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert</span><br><span class="line">  root rl -wi-ao---- &lt;36.97g                                                    </span><br><span class="line">  swap rl -wi-ao----  &lt;2.03g                                                    </span><br><span class="line">[root@hhh ~]# lvcreate -L 3G -n lv-mysql testvg0</span><br><span class="line">  Logical volume &quot;lv-mysql&quot; created.</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">格式化</span></span><br><span class="line">[root@hhh ~]# mkfs.ext4 /dev/testvg0/lv-mysql </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">永久挂载</span></span><br><span class="line">[root@hhh ~]# blkid /dev/testvg0/lv-mysql </span><br><span class="line">/dev/testvg0/lv-mysql: UUID=&quot;48eca6ff-669f-4e33-aed6-9d7be3c5c350&quot; BLOCK_SIZE=&quot;4096&quot; TYPE=&quot;ext4&quot;</span><br><span class="line">[root@hhh ~]# vim /etc/f8stab </span><br><span class="line">UUID=48eca6ff-669f-4e33-aed6-9d7be3c5c350 /root/mysql ext4 defaults 0 0</span><br><span class="line">[root@hhh ~]# mkdir mysql</span><br><span class="line">[root@hhh ~]# mount -a</span><br><span class="line">[root@hhh ~]# df -h </span><br><span class="line">文件系统                       容量  已用  可用 已用% 挂载点</span><br><span class="line">devtmpfs                       874M     0  874M    0% /dev</span><br><span class="line">tmpfs                          893M     0  893M    0% /dev/shm</span><br><span class="line">tmpfs                          893M  8.8M  884M    1% /run</span><br><span class="line">tmpfs                          893M     0  893M    0% /sys/fs/cgroup</span><br><span class="line">/dev/mapper/rl-root             37G  2.0G   36G    6% /</span><br><span class="line">/dev/nvme0n1p1                1014M  210M  805M   21% /boot</span><br><span class="line">tmpfs                          179M     0  179M    0% /run/user/0</span><br><span class="line">/dev/mapper/testvg0-lv--mysql  2.9G  9.0M  2.8G    1% /root/mysql</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>逻辑卷的伸缩和扩容(未学)</strong></p>
<h2 id="总结-v2">总结</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">添加好一块新硬盘后有三个步骤：</span><br><span class="line">1、分区fdisk</span><br><span class="line">2、选择文件系统类型mkfs</span><br><span class="line">3、挂载moount</span><br><span class="line">查看UUID blkid</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">df</span>和<span class="built_in">du</span>的区别 面试题</span></span><br><span class="line">df:查看挂载情况</span><br><span class="line">du:查看文件大小</span><br><span class="line">swap会禁用就行</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RAID各个级别的优缺点、作用	面试题</span></span><br><span class="line">逻辑卷的分区</span><br></pre></td></tr></table></figure>
<h1>rpm</h1>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">rpm常用选项</span></span><br><span class="line">-ivh 安装</span><br><span class="line">-e	卸载</span><br><span class="line">-q	查看包名</span><br><span class="line">-qa	列出所有安装好的包</span><br><span class="line">-ql+包名	列出此包包括的文件列表</span><br><span class="line">-qc+包名	列出次包中的配置文件</span><br><span class="line">-qi+包名	包的说明：版本、安装时间，发行者，功能</span><br><span class="line">-qf+文件名	查询此文件来自于那个包</span><br></pre></td></tr></table></figure>
<h1>yum</h1>
<p>阿里云镜像站：<a target="_blank" rel="noopener" href="https://developer.aliyun.com/mirror/">https://developer.aliyun.com/mirror/</a></p>
<p>清华大学镜像站：<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/">清华大学开源软件镜像站 | Tsinghua Open Source Mirror</a></p>
<p>yum安装失败的原因</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 yum 配置格式有错</span><br><span class="line">2 yum metadata过旧，yum clean all</span><br><span class="line">3 yum 源出问题，网络有问题</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">yum常用命令</span></span><br><span class="line">yum install|remove #下载或卸载</span><br><span class="line">yum list #显示所有已经安装和可以安装的程序包</span><br><span class="line">yum info #查看包的详细信息等同于 rpm -qi </span><br><span class="line">yum provides + 文件路径 #查看这个文件来自于那个包，编译安装用的多</span><br><span class="line">yum history #查看下载历史</span><br><span class="line">yum repoquory -l +包名 #查看未安装包的文件列表</span><br><span class="line">yum clean all #清除目录/var/cache/yum缓存</span><br><span class="line">yum makecache #构建缓存</span><br></pre></td></tr></table></figure>
<p><strong>yum源配置</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">必须的仓库 1、系统仓库 2、epel仓库</span></span><br><span class="line">Centos8: BaseOS APPStream</span><br><span class="line">Centos7: Base</span><br><span class="line"></span><br><span class="line">vim /etc/yum.repo.d/test.repo</span><br><span class="line">[BaseOS] #仓库的唯一标识，避免和其他仓库冲突</span><br><span class="line">name=BaseOS #仓库名字,随便</span><br><span class="line">baseurl=file:// </span><br><span class="line">        http://</span><br><span class="line">        https//</span><br><span class="line">        ftp://</span><br><span class="line">enabled=1 #1为启用此仓库，0是关闭</span><br><span class="line">gpgcheck=0 #是否校验此仓库(1为可用就要配置gpgkey，0为禁用，一般都是禁用)</span><br><span class="line">gpgkey=file:// </span><br><span class="line">        http://</span><br><span class="line">        https//</span><br><span class="line">        ftp://</span><br><span class="line">[APPStream]</span><br><span class="line">……</span><br><span class="line">[epel]</span><br><span class="line">name=EPEL</span><br><span class="line">baseurl=https://mirror.tuna.tsinghua.edu.cn/epel/$releasever/Everything/$basearch</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">相关变量</span></span><br><span class="line">yum的repo配置文件中可用的变量：</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">releasever: 当前OS的发行版的主版本号，如：8，7，6</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash"><span class="built_in">arch</span>: CPU架构，如：aarch64, i586, i686，x86_64等</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">basearch：系统基础平台；i386, x86_64</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">contentdir：表示目录，比如：centos-8，centos-7</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">YUM0-<span class="variable">$YUM9</span>:自定义变量</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">注意：yum仓库指向的路径一定必须是repodata目录所在目录</span></span><br></pre></td></tr></table></figure>
<h1>本地yum真实配置</h1>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">安装自动挂载工具</span></span><br><span class="line">[root@localhost ~]# yum -y install autofs</span><br><span class="line">[root@localhost ~]# systemctl enable --now autofs</span><br><span class="line">[root@localhost ~]# mkdir /misc/cd</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">在vmware上手动挂载光盘</span></span><br><span class="line">[root@localhost ~]# mount /dev/cdrom /misc/cd</span><br><span class="line">[root@localhost ~]# df -h</span><br><span class="line">文件系统             容量  已用  可用 已用% 挂载点</span><br><span class="line">devtmpfs             874M     0  874M    0% /dev</span><br><span class="line">tmpfs                893M     0  893M    0% /dev/shm</span><br><span class="line">tmpfs                893M  8.7M  884M    1% /run</span><br><span class="line">tmpfs                893M     0  893M    0% /sys/fs/cgroup</span><br><span class="line">/dev/mapper/rl-root   37G  2.0G   35G    6% /</span><br><span class="line">/dev/nvme0n1p1      1014M  210M  805M   21% /boot</span><br><span class="line">tmpfs                179M     0  179M    0% /run/user/0</span><br><span class="line">/dev/sr0              11G   11G     0  100% /misc/cd</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">然后再配置yum文件</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">马哥yum源配置文件，最后更新22.10.18</span></span><br><span class="line">[BaseOS]</span><br><span class="line">name=BaseOS</span><br><span class="line">baseurl=file:///misc/cd/BaseOS</span><br><span class="line">        https://mirrors.cloud.tencent.com/centos/8/BaseOS/x86_64/os/</span><br><span class="line">        https://mirrors.aliyun.com/centos/8/BaseOS/x86_64/os/</span><br><span class="line">gpgcheck=0</span><br><span class="line"></span><br><span class="line">[AppStream]</span><br><span class="line">name=AppStream</span><br><span class="line">baseurl=file:///misc/cd/AppStream</span><br><span class="line">        https://mirrors.cloud.tencent.com/centos/8/AppStream/x86_64/os/</span><br><span class="line">        https://mirrors.aliyun.com/centos/8/AppStream/x86_64/os/</span><br><span class="line">gpgcheck=0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[epel]</span><br><span class="line">name=EPEL</span><br><span class="line">baseurl=https://mirror.tuna.tsinghua.edu.cn/epel/$releasever/Everything/$basearch</span><br><span class="line">        https://mirrors.cloud.tencent.com/epel/$releasever/Everything/$basearch</span><br><span class="line">        https://mirrors.huaweicloud.com/epel/$releasever/Everything/$basearch</span><br><span class="line">        https://mirrors.aliyun.com/epel/$releasever/Everything/$basearch</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">[extras]</span><br><span class="line">name=extras</span><br><span class="line">baseurl=https://mirror.tuna.tsinghua.edu.cn/centos/$releasever/extras/$basearch/os</span><br><span class="line">        https://mirrors.cloud.tencent.com/centos/$releasever/extras/$basearch/os</span><br><span class="line">        https://mirrors.huaweicloud.com/centos/$releasever/extras/$basearch/os </span><br><span class="line">        https://mirrors.aliyun.com/centos/$releasever/extras/$basearch/os	</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line"></span><br><span class="line">[PowerTools]</span><br><span class="line">name=CentOS- - PowerTools - mirrors.aliyun.com</span><br><span class="line">baseurl=https://mirror.tuna.tsinghua.edu.cn/centos/$releasever/PowerTools/$basearch/os/</span><br><span class="line">        https://mirrors.cloud.tencent.com/centos/$releasever/PowerTools/$basearch/os/</span><br><span class="line">        https://mirrors.huaweicloud.com/centos/$releasever/PowerTools/$basearch/os/</span><br><span class="line">        https://mirrors.aliyun.com/centos/$releasever/PowerTools/$basearch/os/</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=https://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-Official</span><br></pre></td></tr></table></figure>
<h1>编译安装httpd</h1>
<p><strong>C语言源代码编译安装过程</strong></p>
<p>利用编译工具，通常只需要三个大的步骤</p>
<ul>
<li>./configure</li>
<li>make</li>
<li>make install</li>
</ul>
<p>注意安装前可以通过查看README，INSTALL获取帮助</p>
<p><strong>准备相关的依赖包</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">生成实践：基于最小化安装的系统建议安装下面相关包</span></span><br><span class="line">yum install gcc make autoconf gcc-c++ glibc glibc-devel pcre pcre-devel openssl</span><br><span class="line">openssl-devel systemd-devel zlib-devel vim lrzsz tree tmux lsof tcpdump wget</span><br><span class="line">net-tools iotop bc bzip2 zip unzip nfs-utils man-pages</span><br></pre></td></tr></table></figure>
<p><strong>编译安装</strong></p>
<p>第一步：运行configure脚本，生成Makefile文件</p>
<p>其他选项主要功能：</p>
<ul>
<li>
<p>可以指定安装位置</p>
</li>
<li>
<p>指定启用的特性</p>
<blockquote>
<p>获取其他支持使用的选项<br>
./configure --help<br>
选项分类：</p>
<ul>
<li>安装路径设定
<ul>
<li>–prefix=PATH:指定默认安装位置为/url/local</li>
<li>–sysconfdir=/PATH:配置文件安装位置<br>
System types:支持交叉编译</li>
</ul>
</li>
</ul>
<p>注意：通常被编译操作依赖的程序包，需要安装此程序包的“开发”组件，其包名一般类似于name-devel-VERSION</p>
<p>第二步：make</p>
<p>第三步：make install</p>
</blockquote>
</li>
</ul>
<p>apache官网：<a target="_blank" rel="noopener" href="https://httpd.apache.org/">Welcome! - The Apache HTTP Server Project</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">先下载源文件</span></span><br><span class="line">[root@localhost ~]# wget https://dlcdn.apache.org/httpd/httpd-2.4.54.tar.bz2</span><br><span class="line">[root@localhost httpd]# pwd</span><br><span class="line">/apps/httpd</span><br><span class="line">[root@localhost httpd]# tar xf httpd-2.4.54.tar.bz2 </span><br><span class="line">[root@localhost httpd-2.4.54]# ./configure --prefix=/usr/local/src/</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">报错说没找到ARPconfigure: error: APR not found.  Please <span class="built_in">read</span> the documentation.</span></span><br><span class="line">其实编译安装报这种错很正常，一般在后面加个devel就行了</span><br><span class="line">[root@localhost httpd-2.4.54]# yum -y install apr-devel apr-util-devel</span><br><span class="line">[root@localhost httpd-2.4.54]# yum -y install gcc</span><br><span class="line">[root@localhost httpd-2.4.54]# yum -y install pcre-devel</span><br><span class="line">[root@localhost httpd-2.4.54]# ./configure --prefix=/usr/local/src/</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">最后提示这种就编译安装完成了</span></span><br><span class="line">configure: summary of build options:</span><br><span class="line"></span><br><span class="line">    Server Version: 2.4.54</span><br><span class="line">    Install prefix: /usr/local/src/</span><br><span class="line">    C compiler:     gcc</span><br><span class="line">    CFLAGS:           -pthread  </span><br><span class="line">    CPPFLAGS:        -DLINUX -D_REENTRANT -D_GNU_SOURCE  </span><br><span class="line">    LDFLAGS:           </span><br><span class="line">    LIBS:             </span><br><span class="line">    C preprocessor: gcc</span><br><span class="line">[root@localhost httpd-2.4.54]# make</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">又报错gcc: error: /usr/lib/rpm/redhat/redhat-hardened-ld: No such file or directory</span></span><br><span class="line">解决方法：用yum provides +文件路径看看来自那个包！</span><br><span class="line">[root@localhost httpd-2.4.54]# yum provides /usr/lib/rpm/redhat/redhat-hardened-ld</span><br><span class="line">上次元数据过期检查：0:37:01 前，执行于 2022年10月18日 星期二 11时08分56秒。</span><br><span class="line">redhat-rpm-config-129-1.el8.noarch : Red Hat specific rpm configuration files</span><br><span class="line">仓库        ：AppStream</span><br><span class="line">匹配来源：</span><br><span class="line">文件名    ：/usr/lib/rpm/redhat/redhat-hardened-ld</span><br><span class="line">[root@localhost httpd-2.4.54]# yum -y install redhat-rpm-config</span><br><span class="line">[root@localhost httpd-2.4.54]# make -j 2  #解释：用两个处理器进行编译，速度能更快点</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>脚本安装httpd</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/base</span></span><br><span class="line">cpu=`grep -c processor /proc/cpuinfo`</span><br><span class="line">httpd_version=2.4.54</span><br><span class="line">INSTALL_DIR=/apps/httpd</span><br><span class="line">COLOR=&quot;echo -e \E[32;1m&quot;</span><br><span class="line">END=&quot;\E[0m&quot;</span><br><span class="line"></span><br><span class="line">mkdir -p /apps/httpd</span><br><span class="line">yum -y install apr-devel apr-util-devel gcc pcre-devel redhat-rpm-config</span><br><span class="line">cd /usr/local/src</span><br><span class="line">rpm -q wget || yum -y install install wget</span><br><span class="line">wget https://dlcdn.apache.org/httpd/httpd-2.4.54.tar.bz2 || &#123; $COLOR &quot;下载失败&gt;，退出&quot;$END;exit; &#125;</span><br><span class="line"></span><br><span class="line">tar xf httpd-$httpd_version.tar.bz2</span><br><span class="line"></span><br><span class="line">cd httpd-$&#123;httpd_version&#125;</span><br><span class="line">./configure --prefix=INSTALL_DIR</span><br><span class="line"></span><br><span class="line">make -j $cpu &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">ls -n /apps/httpd/bin/apachectl /usr/local/bin</span><br><span class="line"></span><br><span class="line">apachectl start &amp;&amp; $COLRO&quot;安装成功！&quot;$END</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">COLOR<span class="string">&quot;请访问：http://`hostname -I`&quot;</span><span class="variable">$END</span></span></span><br></pre></td></tr></table></figure>
<h1>网络</h1>
<h2 id="网络配置">网络配置</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Centos8配置网络方法一：</span></span><br><span class="line">[root@localhost ~]# vim /etc/sysconfig/network-scripts/ifcfg-ens160 </span><br><span class="line">修改以下地方：</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">ONBOOT=yes</span><br><span class="line">IPADDR=192.168.1.10</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">GATEWAY=192.168.1.1</span><br><span class="line">DNS1=223.6.6.6</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">方法2：</span></span><br><span class="line">[root@localhost ~]# vim /etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class="line">DEVICE=ens160 </span><br><span class="line">NAME=ens160</span><br><span class="line">BOOTPROTO=none</span><br><span class="line">IPADDR=192.168.1.10</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=192.168.1.1</span><br><span class="line">DNS1=223.6.6.6</span><br><span class="line">ONBOOT=yes</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Centos8重启网络配置命令 7是 systemctl restart network</span></span><br><span class="line">[root@localhost ~]# nmcli connection reload</span><br><span class="line">[root@localhost ~]# nmcli connection up ens160 </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>Ubuntu22.10</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">注意这是20.04的配置，22版的配置有点差别</span></span><br><span class="line">network:</span><br><span class="line"> version: 2</span><br><span class="line"> renderer: networkd</span><br><span class="line"> ethernets:</span><br><span class="line">   eth0:</span><br><span class="line">     addresses: [192.168.8.10/24,10.0.0.10/8]  #或者用下面两行,两种格式不能混用</span><br><span class="line">      - 192.168.8.10/24</span><br><span class="line">      - 10.0.0.10/8</span><br><span class="line">     gateway4: 10.0.0.2</span><br><span class="line">     nameservers:</span><br><span class="line">       search: [magedu.com, magedu.org]</span><br><span class="line">       addresses: [180.76.76.76, 8.8.8.8, 1.1.1.1]</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">这是22.10版的</span></span><br><span class="line">zhang@ubuntu:/etc/netplan$sudo vim ens33.yaml </span><br><span class="line">network:</span><br><span class="line">  version: 2</span><br><span class="line">  renderer: networkd</span><br><span class="line">  ethernets:</span><br><span class="line">    ens33:</span><br><span class="line">      addresses: [192.168.1.111/24]</span><br><span class="line">      optional: true</span><br><span class="line">      routes:</span><br><span class="line">        - to: default</span><br><span class="line">          via: 192.168.1.1</span><br><span class="line">      nameservers:</span><br><span class="line">        search: [baidu.com]</span><br><span class="line">        addresses: [223.6.6.6]</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">注意差别：20的gateway4过期了，当前版本的NetworkManager放弃了这个属性！！</span></span><br></pre></td></tr></table></figure>
<p><strong>开启Ubuntu ssh root</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd root</span><br><span class="line">su root</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">如果没安装ssh的server需要安装</span></span><br><span class="line">apt-get install openssh-server</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">修改/etc/ssh/sshd_config文件</span></span><br><span class="line">vim /etc/ssh/sshd_config</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">把这行的<span class="comment">#号去掉</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">PermitRootLogin prohibit-password</span></span><br><span class="line">PermitRootLogin yes</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">重启服务</span></span><br><span class="line">/etc/init.d/ssh stop</span><br><span class="line">/etc/init.d/ssh start</span><br><span class="line">service ssh restart</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="子网划分">子网划分</h2>
<blockquote>
<p><strong>相关公式：</strong></p>
<ul>
<li>一个网络的最多主机数= 2^主机ID位数-2</li>
<li>网络(段)数= 2^网络ID中可变的位数</li>
<li>网络IP= IP 与 netmask</li>
</ul>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">例题：</span></span><br><span class="line">中国移动10.0.0.0/8 给32个各省公司划分对应的子网</span><br><span class="line">1）每个省公司的子网的netmask？</span><br><span class="line">2^5&gt;=32 借5位网络ID</span><br><span class="line">8+5=13</span><br><span class="line">255.248.0.0</span><br><span class="line"></span><br><span class="line">2)每个省公司的子网的主机数有多少？</span><br><span class="line">2^(32-13)-2=524286</span><br><span class="line"></span><br><span class="line">3）河南省得到第10个子网，网络ID？</span><br><span class="line">10.00000 000.0.0/13</span><br><span class="line">10.01001 000.0.0/13</span><br><span class="line">10.72.0.0/13 </span><br><span class="line"></span><br><span class="line">4）河南省得到第10个子网的最小IP和最大的IP？</span><br><span class="line">10.01001 000.0.1</span><br><span class="line">10.01001 111.11111111.11111110</span><br><span class="line">10.72.0.1---10.79.255.254</span><br><span class="line"></span><br><span class="line">5）所有子网中最大，最小的子网的netid？</span><br><span class="line">10.00000 000.0.0/13 10.0.0.0/13</span><br><span class="line">10.11111 000.0.0/13 10.248.0.0/13</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1>进程、系统性能</h1>
<h2 id="进程和内存管理">进程和内存管理</h2>
<p>内核功用：进程管理、内存管理、文件系统、网络功能、驱动程序、安全功能等</p>
<p><strong>什么是进程</strong></p>
<p>Process: 运行中的程序的一个副本，是被载入内存的一个指令集合。是资源分配的单位</p>
<ul>
<li>进程ID(Process ID, PID)号码被用来标记各个进程</li>
<li>UID、GID和SELinux语境决定对文件系统的存取和访问权限</li>
<li>通常从执行进程的用户来继承</li>
</ul>
<p><strong>进程创建：</strong></p>
<ul>
<li>init：第一个进程，从Centos7以后为systemd</li>
<li>进程：都是其父进程创建，fork()，父子关系，CoW：Copy On Write</li>
</ul>
<p><strong>进程，线程</strong></p>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211220939621.png" alt="image-20221122093957634"></p>
<p><strong>进程</strong></p>
<blockquote>
<p>进程是一个具有一定独立功能的程序在一个数据集上的一次动态执行的过程，是操作系统进行资源分配和调度的一个独立单位，是应用程序运行的载体。进程是一种抽象的概念，从来没有统一的标准定义。</p>
<p>进程一般由程序、数据集合和进程控制块三部分组成。</p>
<p>进程具有的特征：<br>
动态性：进程是程序的一次执行过程，是临时的，有生命期的，是动态产生，动态消亡的；<br>
并发性：任何进程都可以同其他进程一起并发执行；<br>
独立性：进程是系统进行资源分配和调度的一个独立单位；<br>
结构性：进程由程序、数据和进程控制块三部分组成。</p>
</blockquote>
<p><strong>线程</strong></p>
<blockquote>
<p>线程是程序执行中一个单一的顺序控制流程，是程序执行流的最小单元，是处理器调度和分派的基本单位。一个进程可以有一个或多个线程，各个线程之间共享程序的内存空间(也就是所在进程的内存空间)。一个标准的线程由线程ID、当前指令指针(PC)】寄存器和堆栈组成。而进程由内存空间(代码、数据、进程空间、打开的文件)和一个或多个线程组成。</p>
</blockquote>
<p><strong>进程和线程的区别</strong></p>
<blockquote>
<p>线程是程序执行的最小单位，而进程是操作系统分配的最小单位；</p>
<p>一个进程由一个或者多个线程组成，线程是一个进程中代码的不同执行路线；</p>
<p>进程之间相互独立，但同一进程下的各个线程之间共享程序的内存空间(包括代码段、数据集、堆等)及一些进程级的资源(如打开文件和信号)，某进程内的线程在其他进程不可见；</p>
<p>调度和切换：线程上下文切换必进程上下文切换要快得多</p>
</blockquote>
<p><strong>面试题：查看进程中的线程</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -i threads /proc/PID/status</span><br></pre></td></tr></table></figure>
<p><strong>进程状态</strong></p>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211230959778.png" alt="image-20221123095934360"></p>
<p><strong>进程的基本状态</strong></p>
<ul>
<li>创建状态：进程在创建时需要申请一个空白PCB(进程控制块)，向其中填写控制和管理进程的信息，完成资源分配。如果创建工作无法完成，比如资源无法满足，就无法被调度运行，把此时进程所处状态称为创建状态</li>
<li>就绪状态：进程已准备好，已分配到所需资源，只有分配到CPU就能够立即运行</li>
<li>执行状态：进程处于就绪状态被调度后，进程进行执行状态</li>
<li>阻塞状态：正在执行的进程由于某些事件(I/O请求，申请缓冲区失败)而暂时无法运行，进程受到阻塞。在满足请求时进入就绪状态等待系统调用</li>
<li>终止状态：进程结束，或出现失误，或被系统终止，进入终止状态。无法再执行</li>
</ul>
<p><strong>状态之间转换六种情况</strong></p>
<p>运行——&gt;就绪：1、主要是进程占用CPU的时间过长，而系统分配给该进程占用CPU的时间是有限的；</p>
<p>2、在采用抢先式优先级调度算法的系统中,当有更高优先级的进程要运行时，该进程就被迫让出CPU，<br>
该进程便由执行状态转变为就绪状态<br>
就绪——&gt;运行：运行的进程的时间片用完，调度就转到就绪队列中选择合适的进程分配CPU</p>
<p>运行——&gt;阻塞：正在执行的进程因发生某等待事件而无法执行，则进程由执行状态变为阻塞状态，如发<br>
生了I/O请求</p>
<p>阻塞——&gt;就绪:进程所等待的事件已经发生，就进入就绪队列<br>
以下两种状态是不可能发生的：<br>
阻塞——&gt;运行：即使给阻塞进程分配CPU，也无法执行，操作系统在进行调度时不会从阻塞队列进行挑<br>
选，而是从就绪队列中选取</p>
<p>就绪——&gt;阻塞：就绪态根本就没有执行，谈不上进入阻塞态</p>
<p><strong>进程更多的状态：</strong></p>
<ul>
<li>运行态：running</li>
<li>就绪态：ready</li>
<li>睡眠态：分为两种，可中断(interruptable)，不可中断(uninterruptable)</li>
<li>停止态：stopped，暂停于内存，但不会被调度，除非手动启动</li>
<li>僵死态：zombie，僵尸态，结束进程，父进程结束前，子进程不关闭，杀死父进程可以关闭僵死态的子进程</li>
</ul>
<p><strong>LUR算法</strong></p>
<p>LRU：Least Recently Used近期最少使用算法(喜新厌旧)，释放内存。缓存用的就是这个机制，用的频繁就越不容易淘汰，反之</p>
<p><strong>IPC进程间通信</strong></p>
<ul>
<li>
<p>同一主机:</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Pipe	管道，单向传输</span><br><span class="line">scket	套接字文件，双工通信</span><br><span class="line">Memory-maped file	文件映射，将文件中的一端数据映射到物理内存，多个进程共享这片内存</span><br><span class="line">shm shared memory	共享内存</span><br><span class="line">signal	信号</span><br><span class="line">Lock	对资源上锁，如果资源已被某进程锁住，则其他进程想修改甚至读取这些资源，都将被阻塞，直到锁被打开</span><br><span class="line">semaphore	信号量，一种计数器</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>不同主机：socket = IP和端口号</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RPC	远程过程调用(remote procedure call)</span><br><span class="line">MQ	消息队列，生产者和消费者，如kafka,rabbitMQ,ActiveMQ</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="1-5-进程优先级">1.5 进程优先级</h3>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.jsdelivr.net/gh/wqingzy/blog-img/img/202211241544944.png" alt="image-20221123110611498"></p>
</li>
</ul>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">系统优先级：0-139,数字越小，优先级越高，各有140个运行队列和过期队列</span><br><span class="line">实时优先级: 99-0 值最大优先级最高</span><br><span class="line">nice值：-20到19，对应系统优先级100-139</span><br></pre></td></tr></table></figure>
<h2 id="进程管理命令和工具">进程管理命令和工具</h2>
<p><strong>进程树pstree</strong></p>
<p>pstree可以用来显示进程的父子关系，以树形结构显示</p>
<p>常用选项：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-p	显示PID</span><br><span class="line">-T	不显示线程thread，默认显示线程</span><br><span class="line">-u	显示用户切换</span><br><span class="line">-H pid 高亮显示指定进程及其前辈进程</span><br></pre></td></tr></table></figure>
<p><strong>进程信息PS</strong></p>
<p>ps可以进程当前状态的快照，默认显示当前终端中的进程，Linux系统各进程的相关信息均保存再/proc/PID目录下的各文件中</p>
<p>常用选项：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">c:	ps -ef 显示列 c 表示cpu利用率</span><br><span class="line">vsz:	虚拟内存集，线性内存</span><br><span class="line">RSS:	常驻内存集</span><br><span class="line">STAT：进程状态</span><br><span class="line">	R:运行 running</span><br><span class="line">	S:可终止睡眠 interruptable sleeping</span><br><span class="line">	D:不可终止睡眠 uninterruptable sleeping</span><br><span class="line">	T:停止 stopped</span><br><span class="line">	Z:zombie 僵尸态</span><br><span class="line">	+:前途进程</span><br><span class="line">	l:多线程进程</span><br><span class="line">	L:内存分页并带锁</span><br><span class="line">	N:低优先级进程</span><br><span class="line">	&lt;:高优先级进程</span><br><span class="line">	s:会话(子进程)发起者</span><br><span class="line">	I:</span><br><span class="line">ni: niec值</span><br><span class="line">pri: priority 优先级</span><br><span class="line">rtprio：实时优先级</span><br><span class="line">psr：processor cpu编号</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">常用的: ps aux</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">按CPU利用率排正序</span></span><br><span class="line">[root@Blog ~]# ps aux k -%cpu</span><br></pre></td></tr></table></figure>
<p><strong>查看进程信息prtstat</strong></p>
<p>可以显示进程信息，来自于psmisc包</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">选项： -r raw格式显示</span><br><span class="line">[root@Blog ~]# prtstat 35139</span><br><span class="line">Process: bash          		State: S (sleeping)</span><br><span class="line"><span class="meta prompt_">  CPU#</span><span class="language-bash">:  0  		TTY: 136:0	Threads: 1</span></span><br><span class="line">Process, Group and Session IDs</span><br><span class="line">  Process ID: 35139		  Parent ID: 35138</span><br><span class="line">    Group ID: 35139		 Session ID: 35139</span><br><span class="line">  T Group ID: 35201</span><br><span class="line"></span><br><span class="line">Page Faults</span><br><span class="line">  This Process    (minor major):     1661         0</span><br><span class="line">  Child Processes (minor major):     3967         3</span><br><span class="line">CPU Times</span><br><span class="line">  This Process    (user system guest blkio):   0.02   0.00   0.00   0.00</span><br><span class="line">  Child processes (user system guest):         0.02   0.02   0.00</span><br><span class="line">Memory</span><br><span class="line">  Vsize:       28 MB     </span><br><span class="line">  RSS:         5197 kB    		 RSS Limit: 18446744073709 MB</span><br><span class="line">  Code Start:  0x5584f9491000		 Code Stop:  0x5584f9598950</span><br><span class="line">  Stack Start: 0x7ffc605ec6d0</span><br><span class="line">  Stack Pointer (ESP):          0	 Inst Pointer (EIP):          0</span><br><span class="line">Scheduling</span><br><span class="line">  Policy: normal</span><br><span class="line">  Nice:   0 		 RT Priority: 0 (non RT)</span><br></pre></td></tr></table></figure>
<p><strong>设置和调整进程优先级</strong></p>
<p>进程优先级调整</p>
<ul>
<li>静态优先级: 100-139</li>
<li>进程默认启动时的nice值为0，优先级为120</li>
<li>只有根用户才能降低nice值(提高优先性)</li>
</ul>
<p>nice -n ：以指定的优先级来启动进程</p>
<p>renice -n ：可以调整正在执行中的进程的优先级</p>
<h2 id="搜索进程">搜索进程</h2>
<p>按条件搜索进程</p>
<ul>
<li>ps选项 | grep ‘pattern’ 灵活</li>
<li>pgrep 按预定义的模式</li>
<li>/sbin/pidof 按确切的程序名称查看pid</li>
</ul>
<p><strong>pgrep命令和pidof</strong></p>
<p>常用选项</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-u uid:	命令生效者</span><br><span class="line">-U uid:	真正发起运行命令者</span><br><span class="line">-t：与指定终端相关的进程</span><br><span class="line">-l: 显示进程名</span><br><span class="line">-a: 显示完整格式的进程名</span><br><span class="line">-P pid: 显示指定进程的子进程</span><br></pre></td></tr></table></figure>
<p><strong>案例</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">显示PID和进程名字</span></span><br><span class="line">[root@Blog ~]# pgrep -lu root</span><br><span class="line">1 systemd</span><br><span class="line">2 kthreadd</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>pidof</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">常用选项： -X 按脚本名称查找pid</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ping.sh必须有shebang机制,否则pidof -x 也无法查找到</span></span><br><span class="line">[root@centos7 ~]#pidof -x ping.sh</span><br><span class="line">19035</span><br></pre></td></tr></table></figure>
<h2 id="负载查询uptime">负载查询uptime</h2>
<p>/proc/uptime包括两个值，单位s</p>
<ul>
<li>系统启动时长</li>
<li>空闲进程的总时长(按总的CPU核数显示)</li>
</ul>
<p>uptime和w显示以下内容</p>
<ul>
<li>当前时间</li>
<li>系统已启动的时间</li>
<li>当前上线人数</li>
<li>系统平均负载(1、5、15分钟的平均负载，一般不会超过1，超过5时建议报警)</li>
</ul>
<p>系统平均负载: 指在特定时间间隔内运行队列中的平均进程数,通常每个CPU内核的当前活动进程数不大 于3，那么系统的性能良好。如果每个CPU内核的任务数大于5，那么此主机的性能有严重问题</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@Blog ~]# uptime</span><br><span class="line"> 15:37:27 up 19 days, 19:01,  2 users,  load average: 0.01, 0.02, 0.00</span><br><span class="line">    时间     运行了19分钟      两个用户     负载平均值: 分钟的,5分钟的,15分钟的</span><br><span class="line">    </span><br><span class="line">[root@Blog ~]# w</span><br><span class="line"> 15:40:06 up 19 days, 19:04,  2 users,  load average: 0.07, 0.05, 0.01</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root     pts/0    113.74.116.205   14:43    6:54   0.05s  0.05s -bash</span><br><span class="line">root     pts/1    113.74.116.205   15:33    1.00s  0.02s  0.00s w</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="查看进程实时状态top和htop">查看进程实时状态top和htop</h2>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.staticaly.com/gh/wqingzy/blog-img@main/img/image-20221124160401972.png" alt="image-20221124160401972"></p>
<p>top提供动态的实时进程状态</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">有许多内置命令</span></span><br><span class="line">排序:</span><br><span class="line">P：以占据的CPU百分比，%CPU</span><br><span class="line">M: 占据内存百分比，%MEM</span><br><span class="line">T: 累计占据CPU时长，TIME+</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">首部信息显示：</span></span><br><span class="line">uptime信息: l命令</span><br><span class="line">tasks及cpu信息:t命令</span><br><span class="line">cpu分别显示: 1(数字)</span><br><span class="line">memory信息: m命令</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">退出命令: q</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">修改刷新时间间隔: s</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">终止指定进程:k</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">保存文件:w</span></span><br></pre></td></tr></table></figure>
<p>top命令栏位信息简介</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">us：用户空间</span><br><span class="line">sy：内核空间</span><br><span class="line">ni：调整nice时间</span><br><span class="line">id：空闲</span><br><span class="line">wa：等待IO时间</span><br><span class="line">hi：硬中断</span><br><span class="line">si：软中断(模式切换)</span><br><span class="line">st：虚拟机偷走的时间</span><br></pre></td></tr></table></figure>
<p>top选项:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-d #指定刷新时间间隔，默认为e</span><br><span class="line">-b #全部显示所有进程</span><br><span class="line">-n #刷新多少次后退出</span><br><span class="line">-H #线程模式</span><br><span class="line">-p #指定进程号</span><br></pre></td></tr></table></figure>
<p><strong>htop</strong></p>
<p>htop命令是增强版的TOP命令，来自EPEL元，必top功能更强，理解即可</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install htop</span><br></pre></td></tr></table></figure>
<h2 id="内存空间-free">内存空间 free</h2>
<p>free 查看内存空间的使用状态</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">常用选项:用的最多的是 free -h</span></span><br><span class="line">-b 以字节为单位</span><br><span class="line">-m 以MB为单位</span><br><span class="line">-g 以GB为单位</span><br><span class="line">-h 易读格式</span><br><span class="line">-o 不显示-/+buffers/cache行</span><br><span class="line">-t   显示RAM + swap的总和</span><br><span class="line">-s n 刷新间隔为n秒</span><br><span class="line">-c n 刷新n次后即退出</span><br></pre></td></tr></table></figure>
<p>中间还有一些…</p>
<h2 id="查看进程打开文件lsof">查看进程打开文件lsof</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">利用lsof恢复正在使用中的误删除的文件</span></span><br><span class="line">lsof |grep /var/log/messages</span><br><span class="line">rm -f /var/log/messages</span><br><span class="line">lsof |grep /var/log/messages</span><br><span class="line">cat /proc/653/fd/6</span><br><span class="line">cat /proc/653/fd/6 &gt; /var/log/messages</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="信号发送-kill">信号发送 kill</h2>
<p>kill：内部命令，可用来向进程发送控制信号，以实现对进程管理，每个信号对应一个数字，信号名称以SIG开头(可省略)，不区分大小写</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">显示当前系统可用信号:</span></span><br><span class="line">kill -l</span><br><span class="line">trap -l</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">常用信号:</span></span><br><span class="line">1 SIGHUP	无需关闭进程而让其重读配置</span><br><span class="line">2 SIGINT	中止正在运行的进程，相当于Ctrl+c</span><br><span class="line">3 SIGQUIT	相当于Ctrl+\</span><br><span class="line">9 SIGKILL	强制杀死正在运行的进程，默认信号</span><br><span class="line">15 SIGTERM	强制杀死正在运行的进程，可能会导致数据丢失，慎用！</span><br><span class="line">18 SIGCONT	继续运行</span><br><span class="line">19 SIGSTOP	后台休眠</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">用法:</span></span><br><span class="line">向进程发送信号 按PID</span><br><span class="line">kill -1 PID</span><br></pre></td></tr></table></figure>
<p><strong>作业管理</strong></p>
<p>Linux的作业控制</p>
<ul>
<li>前台作业：通过终端启动，且启动后一直占据终端</li>
<li>后台作业：可通过终端启动，但启动后及转入后台运行(释放终端)</li>
</ul>
<p><img src= "/picteurl/01.jpg" data-lazy-src="https://cdn.staticaly.com/gh/wqingzy/blog-img@main/img/image-20221125093009414.png" alt="image-20221125093009414"></p>
<p>让作业运行于后台</p>
<ul>
<li>运行中的作业：Ctrl+z</li>
<li>尚未启动的作业：OMMAND&amp;</li>
</ul>
<p>后台作业虽然被送往后台运行，但其依然于终端相关；退出终端等于关闭后台作业。如果希望送往后台后，剥离与终端的关系</p>
<ul>
<li>nohup COMMADN &amp; &gt;/dev/null &amp;</li>
<li>screen; COMMAND</li>
<li>tmux; COMMAND</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">相关命令</span></span><br><span class="line">jobs	#查看当前终端所有作业</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">作业控制:</span></span><br><span class="line">fg [PID或者程序名称]：把指定的后台作业跳回前台</span><br><span class="line">bg [PID或者程序名称]：让送我后台的作业在后台继续运行</span><br><span class="line">kill [PID或者程序名称]：终止指定的作业</span><br></pre></td></tr></table></figure>
<p>案例：后台运行的进程和终端关系</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">终端1运行后台程序</span></span><br><span class="line">[root@Blog ~]# ping 127.0.0.1 &amp;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">终端2 可以查看到进程，但再关闭终端1后，再终端2就查看不到该进程</span></span><br><span class="line">[root@Blog ~]# ps aux |grep ping</span><br><span class="line">root       38476  0.0  0.1  32476  2404 ?        S    09:41   0:00 ping 127.0.0.1</span><br><span class="line">root       38506  0.0  0.1  32476  2420 pts/2    S    09:41   0:00 ping 127.0.0.1</span><br><span class="line">root       38508  0.0  0.0  12140  1072 pts/1    S+   09:41   0:00 grep --color=auto ping</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>nohup希望终端关闭后，程序依然执行</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@Blog ~]# nohup ping 127.0.0.1</span><br><span class="line">nohup: ignoring input and appending output to &#x27;nohup.out&#x27;</span><br></pre></td></tr></table></figure>
<p><strong>并行运行</strong></p>
<p>利用后台执行，实现并行功能，及同时运行多个进程，提供效率</p>
<p>方法1</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat all.sh</span><br><span class="line">f1.sh&amp;</span><br><span class="line">f2.sh&amp;</span><br><span class="line">f3.sh&amp;</span><br></pre></td></tr></table></figure>
<p>方法2</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(f1.sh&amp;);(f2.sh&amp;);(f3.sh&amp;)</span><br></pre></td></tr></table></figure>
<p>方法3</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f1.sh&amp;f2.sh&amp;f3.sh&amp; </span><br></pre></td></tr></table></figure>
<p>案例:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">多组命令实现并行</span></span><br><span class="line">[root@Blog ~]# &#123; ping -c3 127.1; ping 127.2; &#125;&amp; &#123; ping -c3 127.3 ;ping 127.4;&#125;&amp;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">之前写的脚本 探测192.168.1.0这个网段有多少主机可以ping通，寻常写法要等245秒，并行执行只需要1秒就可以，大幅度提高了工作效率。</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">net=10.0.0</span><br><span class="line">for i in &#123;1..254&#125;;do</span><br><span class="line">   &#123;</span><br><span class="line">    if ping -c1 -W1 $net.$i &amp;&gt; /dev/null;then</span><br><span class="line">        echo $net.$i is up</span><br><span class="line">    else</span><br><span class="line">        echo $net.$i is down</span><br><span class="line">    fi</span><br><span class="line">       &#125;&amp;</span><br><span class="line">done</span><br><span class="line">wait #wait 让后台执行的程序自动退出</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1>任务计划</h1>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>Linux基础(持续更新中...)</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="http://zhangguichuan.top/2022/11/17/Linux-Linux/">http://zhangguichuan.top/2022/11/17/Linux-Linux/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>优秀い</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2022-11-17</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2022-12-08</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Linux/">Linux</a></div><div class="post_share"><div class="social-share" data-image="/%5Cpicture%5Cdefault_cover_40.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/11/14/2022-11-14%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/"><img class="prev-cover" src= "/picteurl/01.jpg" data-lazy-src="/%5Cpicture%5Cdefault_cover_205.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">第一篇文章</div></div></a></div><div class="next-post pull-right"><a href="/2022/11/18/%E8%BD%AF%E8%80%83-%E8%BD%AF%E8%80%83/"><img class="next-cover" src= "/picteurl/01.jpg" data-lazy-src="/%5Cimg%5Cdefault_cover_9.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">软考-网工</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/12/13/Linux-1/" title="略略略"><img class="cover" src= "/picteurl/01.jpg" data-lazy-src="/%5Cimg%5Cdefault_cover_3.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-13</div><div class="title">略略略</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/picteurl/01.jpg" data-lazy-src="/picture/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">优秀い</div><div class="author-info__description">真诚才是必杀技！</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">10</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/wqingzy"><i class="fab fa-github"></i><span>🛴前往小家...</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/wqingzy" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1851504989@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的博客！文章图片有问题(有空会找一下原因)</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">Linux基础</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">1.‘’ “” &#96;&#96; { } 的介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">用户管理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">文件权限</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E7%9A%84%E9%BB%98%E8%AE%A4%E6%9D%83%E9%99%90"><span class="toc-number">4.1.</span> <span class="toc-text">新建文件和目录的默认权限</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E6%9D%83%E9%99%90"><span class="toc-number">4.2.</span> <span class="toc-text">特殊权限</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">5.</span> <span class="toc-text">vim</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%A8%A1%E5%BC%8F"><span class="toc-number">5.1.</span> <span class="toc-text">基础模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E5%AE%9A%E7%95%8C"><span class="toc-number">5.2.</span> <span class="toc-text">地址定界</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E5%B9%B6%E6%9B%BF%E6%8D%A2"><span class="toc-number">5.3.</span> <span class="toc-text">查找并替换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89vim%E5%B7%A5%E4%BD%9C%E7%89%B9%E6%80%A7"><span class="toc-number">5.4.</span> <span class="toc-text">自定义vim工作特性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F"><span class="toc-number">5.5.</span> <span class="toc-text">命令模式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">6.</span> <span class="toc-text">文件查找</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#find"><span class="toc-number">6.1.</span> <span class="toc-text">find</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E6%9B%BF%E6%8D%A2xargs"><span class="toc-number">6.2.</span> <span class="toc-text">参数替换xargs</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">7.</span> <span class="toc-text">正则表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E5%8C%B9%E9%85%8D"><span class="toc-number">7.1.</span> <span class="toc-text">字符匹配</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E6%AC%A1%E6%95%B0"><span class="toc-number">7.2.</span> <span class="toc-text">匹配次数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%8D%E7%BD%AE%E9%94%9A%E5%AE%9A"><span class="toc-number">7.3.</span> <span class="toc-text">位置锚定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%BB%84"><span class="toc-number">7.4.</span> <span class="toc-text">分组()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%96%E8%80%85"><span class="toc-number">7.5.</span> <span class="toc-text">或者</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E6%AD%A3%E5%88%99"><span class="toc-number">7.6.</span> <span class="toc-text">扩展正则</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">8.</span> <span class="toc-text">三剑客</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#grep"><span class="toc-number">8.1.</span> <span class="toc-text">grep</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sed"><span class="toc-number">8.2.</span> <span class="toc-text">sed</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#awk"><span class="toc-number">8.3.</span> <span class="toc-text">awk</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Program%E6%A0%BC%E5%BC%8F%EF%BC%9A"><span class="toc-number">8.3.1.</span> <span class="toc-text">Program格式：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#awk%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B"><span class="toc-number">8.3.2.</span> <span class="toc-text">awk工作过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E9%9A%94%E7%AC%A6%E3%80%81%E5%9F%9F%E3%80%81%E5%92%8C%E8%AE%B0%E5%BD%95"><span class="toc-number">8.3.3.</span> <span class="toc-text">分隔符、域、和记录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E4%BD%9Cprint"><span class="toc-number">8.3.4.</span> <span class="toc-text">动作print</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#awk%E5%8F%98%E9%87%8F"><span class="toc-number">8.3.5.</span> <span class="toc-text">awk变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E4%BD%9Cprintf"><span class="toc-number">8.3.6.</span> <span class="toc-text">动作printf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">8.3.7.</span> <span class="toc-text">操作符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8FPATTERN"><span class="toc-number">8.3.8.</span> <span class="toc-text">模式PATTERN</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">9.</span> <span class="toc-text">shell</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-number">9.1.</span> <span class="toc-text">变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E8%A6%81%E6%B1%82"><span class="toc-number">9.1.1.</span> <span class="toc-text">命令要求</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E7%AE%97%E7%9B%B8%E5%85%B3"><span class="toc-number">9.2.</span> <span class="toc-text">运算相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%97%E6%95%B0%E8%BF%90%E7%AE%97"><span class="toc-number">9.2.1.</span> <span class="toc-text">算数运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97"><span class="toc-number">9.2.2.</span> <span class="toc-text">逻辑运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%AD%E8%B7%AF%E8%BF%90%E7%AE%97"><span class="toc-number">9.2.3.</span> <span class="toc-text">短路运算</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95"><span class="toc-number">9.3.</span> <span class="toc-text">条件测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%B5%8B%E8%AF%95"><span class="toc-number">9.4.</span> <span class="toc-text">文件测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E4%BA%8E-%E5%92%8C"><span class="toc-number">9.5.</span> <span class="toc-text">关于( )和{ }</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#read"><span class="toc-number">9.6.</span> <span class="toc-text">read</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shell%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">9.7.</span> <span class="toc-text">shell的配置文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#if"><span class="toc-number">9.8.</span> <span class="toc-text">if</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#while"><span class="toc-number">9.9.</span> <span class="toc-text">while</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7"><span class="toc-number">9.10.</span> <span class="toc-text">脚本工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#expect"><span class="toc-number">9.10.1.</span> <span class="toc-text">expect</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E7%BB%84"><span class="toc-number">9.11.</span> <span class="toc-text">数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">9.12.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">10.</span> <span class="toc-text">磁盘和存储管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%8C%BA%E6%96%B9%E5%BC%8F"><span class="toc-number">10.1.</span> <span class="toc-text">分区方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%B1%BB%E5%9E%8B"><span class="toc-number">10.2.</span> <span class="toc-text">文件系统类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%82%E8%BD%BD"><span class="toc-number">10.3.</span> <span class="toc-text">挂载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B8%E4%B9%85%E6%8C%82%E8%BD%BD"><span class="toc-number">10.4.</span> <span class="toc-text">永久挂载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#swap%E4%BA%A4%E6%8D%A2%E5%88%86%E5%8C%BA"><span class="toc-number">10.5.</span> <span class="toc-text">swap交换分区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dd-%E7%A3%81%E7%9B%98%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7"><span class="toc-number">10.6.</span> <span class="toc-text">dd 磁盘测试工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RAID"><span class="toc-number">10.7.</span> <span class="toc-text">RAID</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E5%8D%B7%E7%AE%A1%E7%90%86-LVM"><span class="toc-number">10.8.</span> <span class="toc-text">逻辑卷管理(LVM)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-v2"><span class="toc-number">10.9.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">11.</span> <span class="toc-text">rpm</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">12.</span> <span class="toc-text">yum</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">13.</span> <span class="toc-text">本地yum真实配置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">14.</span> <span class="toc-text">编译安装httpd</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">15.</span> <span class="toc-text">网络</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE"><span class="toc-number">15.1.</span> <span class="toc-text">网络配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86"><span class="toc-number">15.2.</span> <span class="toc-text">子网划分</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">16.</span> <span class="toc-text">进程、系统性能</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E5%92%8C%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="toc-number">16.1.</span> <span class="toc-text">进程和内存管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-%E8%BF%9B%E7%A8%8B%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">16.1.1.</span> <span class="toc-text">1.5 进程优先级</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4%E5%92%8C%E5%B7%A5%E5%85%B7"><span class="toc-number">16.2.</span> <span class="toc-text">进程管理命令和工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E8%BF%9B%E7%A8%8B"><span class="toc-number">16.3.</span> <span class="toc-text">搜索进程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%9F%E8%BD%BD%E6%9F%A5%E8%AF%A2uptime"><span class="toc-number">16.4.</span> <span class="toc-text">负载查询uptime</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B%E5%AE%9E%E6%97%B6%E7%8A%B6%E6%80%81top%E5%92%8Chtop"><span class="toc-number">16.5.</span> <span class="toc-text">查看进程实时状态top和htop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4-free"><span class="toc-number">16.6.</span> <span class="toc-text">内存空间 free</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6lsof"><span class="toc-number">16.7.</span> <span class="toc-text">查看进程打开文件lsof</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E5%8F%B7%E5%8F%91%E9%80%81-kill"><span class="toc-number">16.8.</span> <span class="toc-text">信号发送 kill</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">17.</span> <span class="toc-text">任务计划</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022  <i id="heartbeat" class="fa fas fa-heartbeat"></i> 优秀い</div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.<p><a target="_blank" href="https://hexo.io/"><img src= "/picteurl/01.jpg" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src= "/picteurl/01.jpg" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src= "/picteurl/01.jpg" data-lazy-src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src= "/picteurl/01.jpg" data-lazy-src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src= "/picteurl/01.jpg" data-lazy-src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src= "/picteurl/01.jpg" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src= "/picteurl/01.jpg" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div><link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="7754326279" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="30" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
    function butterfly_categories_card_injector_config(){
      var parent_div_git = document.getElementById('recent-posts');
      var item_html = '<style>li.categoryBar-list-item{width:32.3%;}.categoryBar-list{max-height: 190px;overflow:auto;}.categoryBar-list::-webkit-scrollbar{width:0!important}@media screen and (max-width: 650px){.categoryBar-list{max-height: 160px;}}</style><div class="recent-post-item" style="height:auto;width:100%;padding:0px;"><div id="categoryBar"><ul class="categoryBar-list"><li class="categoryBar-list-item" style="background:url(/img/dm5.webp);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/Linux/&quot;);" href="javascript:void(0);">Linux</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr">运维</span></li><li class="categoryBar-list-item" style="background:url(/img/default_cover_151.webp);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/other/&quot;);" href="javascript:void(0);">other</a><span class="categoryBar-list-count">4</span><span class="categoryBar-list-descr">Linux练习题</span></li><li class="categoryBar-list-item" style="background:url(/img/fj2.webp);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/软考/&quot;);" href="javascript:void(0);">软考</a><span class="categoryBar-list-count">1</span><span class="categoryBar-list-descr">网络工程师</span></li><li class="categoryBar-list-item" style="background:url(/img/fj4.webp);"> <a class="categoryBar-list-link" onclick="pjax.loadUrl(&quot;categories/网络/&quot;);" href="javascript:void(0);">网络</a><span class="categoryBar-list-count">2</span><span class="categoryBar-list-descr">数通</span></li></ul></div></div>';
      console.log('已挂载butterfly_categories_card')
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      }
    if( document.getElementById('recent-posts') && (location.pathname ==='/'|| '/' ==='all')){
    butterfly_categories_card_injector_config()
    }
  </script><script data-pjax>
  function butterfly_clock_anzhiyu_injector_config(){
    var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
    var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img class="entered loading" id="card-clock-loading" src= "/picteurl/01.jpg" data-lazy-src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading"/></div></div></div></div></div>';
    console.log('已挂载butterfly_clock_anzhiyu')
    if(parent_div_git) {
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var qweather_key = 'ea6405360a7f4c54913d5e031c07ad4d';
  var gaud_map_key = '94978c8d29991f3a59c41c2744f4b164';
  var baidu_ak_key = 'undefined';
  var flag = 0;
  var clock_rectangle = '113.34532,23.15624';
  var clock_default_rectangle_enable = 'false';

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_clock_anzhiyu_injector_config();
  }
  else if (epage === cpage){
    butterfly_clock_anzhiyu_injector_config();
  }
  </script><script src="https://widget.qweather.net/simple/static/js/he-simple-common.js?v=2.0"></script><script data-pjax src="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu/lib/clock.min.js"></script><!-- hexo injector body_end end --></body></html>